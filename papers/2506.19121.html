<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>CUPID: Curating Data your Robot Loves with Influence Functions - Robotics arXiv Daily</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="../assets/styles.css"/>
  <link rel="stylesheet" href="../assets/detail.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/>
</head>
<body>
  <div class="bg-orbit"></div>
  <header class="site-header">
    <div class="brand">
      <a href="../index.html" class="back-link">← 返回列表</a>
    </div>
  </header>
  <main class="detail-main">
    <article class="detail-card">
      <span class="detail-category">Manipulation</span>
      <h1>CUPID: Curating Data your Robot Loves with Influence Functions</h1>
      <div class="detail-meta">
        <span>arXiv: <a href="http://arxiv.org/abs/2506.19121" target="_blank" rel="noreferrer">2506.19121</a></span>
        <span>作者: Jeannette Bohg Team</span>
        <span>日期: 2025-06-23</span>
      </div>
      <section class="detail-body">
        <h2>📝 详细解读</h2>
        <h2 id="研究背景与动机">研究背景与动机</h2>
<p>在机器人模仿学习中，策略性能与演示数据的质量和构成紧密耦合。然而，当前方法难以精确理解个体演示如何影响下游结果（如闭环任务成功或失败）。主流方法通常依赖启发式、与任务无关的质量度量来筛选数据，或者尝试使用在线策略经验学习相关启发式，但都未能建立训练数据与策略行为之间的强因果联系，存在误归因风险。本文针对“如何理解并量化单个演示数据对策略闭环性能的真实贡献”这一具体痛点，提出了一个基于影响函数理论的新视角，将数据筛选形式化为识别那些对策略预期回报影响最大的演示的问题。本文的核心思路是：利用影响函数来估计每个训练演示对策略预期回报的影响，从而根据其对闭环性能的影响来排名和选择演示，实现数据筛选（过滤有害数据）和选择（优选新数据）。</p>
<h2 id="方法详解">方法详解</h2>
<p>CUPID的整体流程是：首先，在一个演示数据集 $\mathcal{D}$ 上通过行为克隆训练一个基础策略 $\pi_\theta$；然后，在线评估该策略，收集一组闭环轨迹 $\mathcal{D}_\tau$ 及其回报；接着，利用影响函数估计每个演示 $\xi$ 对这些评估轨迹回报的“性能影响”；最后，根据性能影响的估计值对演示进行排名，执行筛选（移除负影响最大的演示）或选择（添加正影响最大的新演示）。</p>
<p><img src="https://arxiv.org/html/2506.19121v2/x2.png" alt="方法框架"></p>
<blockquote>
<p><strong>图2</strong>：CUPID数据筛选流程。左侧：通过行为克隆在演示数据集上训练策略。中间：在线评估策略以收集闭环轨迹并估计预期回报。右侧：CUPID根据估计的性能影响对演示进行排名和选择。最终得到一个对闭环策略成功影响最大的演示数据集。</p>
</blockquote>
<p>核心模块是<strong>性能影响</strong>的估计。其定义为：若在训练目标中对演示 $\xi$ 的损失施加一个无穷小权重 $\epsilon$，策略预期回报 $J(\pi_\theta)$ 对 $\epsilon$ 的导数，即 $\Psi_{\pi\text{-}\mathrm{inf}}(\xi) = dJ(\pi_\theta)/d\epsilon|<em>{\epsilon=0}$。直接计算不可行，因为 $J(\pi_\theta)$ 依赖于未知的动态和奖励。关键创新在于<strong>命题1</strong>，它将性能影响分解为更基础的<strong>动作影响</strong>的加权和：$\Psi</em>{\pi\text{-}\mathrm{inf}}(\xi) = \mathbb{E}<em>{\tau \sim p(\tau|\pi_\theta)} [ \frac{R(\tau)}{H} \sum</em>{(s&#39;,a&#39;) \in \tau} \sum_{(s,a) \in \xi} \Psi_{a\text{-}\mathrm{inf}}((s&#39;,a&#39;), (s,a)) ]$。其中，动作影响 $\Psi_{a\text{-}\mathrm{inf}}$ 衡量的是训练状态-动作对 $(s,a)$ 对策略在测试状态-动作对 $(s&#39;,a&#39;)$ 上对数似然的影响，这可以通过标准影响函数技术（如TRAK）高效计算。</p>
<p>因此，估计性能影响的步骤（算法1）为：1) 收集策略的评估轨迹 $\mathcal{D}_\tau$ 及其回报；2) 使用数据归因方法计算所有评估轨迹与目标演示之间所有状态-动作对的成对动作影响；3) 根据命题1的公式，用评估轨迹集上的经验平均来估计性能影响。</p>
<p><img src="https://arxiv.org/html/2506.19121v2/x3.png" alt="性能影响分解"></p>
<blockquote>
<p><strong>图3</strong>：性能影响分解示意图。一个演示 $\xi$ 对策略回报 $J(\pi_\theta)$ 的总体影响，可以分解为该演示中每个训练状态-动作对 $(s,a)$ 对策略在评估轨迹 $\tau$ 中每个动作 $(s&#39;, a&#39;)$ 的影响（即动作影响）的加权和，权重为轨迹的回报 $R(\tau)$。</p>
</blockquote>
<p>基于估计的性能影响 $\widehat{\Psi}_{\pi\text{-}\mathrm{inf}}(\xi)$，可以近似计算“留一影响”和“添一影响”，分别对应移除或添加一个演示对预期回报的变化。数据筛选任务（公式4）即选择留一影响最小的 $k$ 个演示（即对当前性能负贡献最大）进行移除；数据选择任务（公式5）即选择添一影响最大的 $k$ 个演示进行添加。这构建了一个用于性能预测的线性数据模型。</p>
<p><img src="https://arxiv.org/html/2506.19121v2/x4.png" alt="质量指标"></p>
<blockquote>
<p><strong>图4</strong>：基于动作影响构建的与奖励无关的演示质量指标 $\Psi_{\text{qual}}$ 示意图。该指标衡量一个演示 $\xi$ 与策略产生的状态分布之间的覆盖范围，值越大表示质量越高。</p>
</blockquote>
<p>由于性能影响估计依赖于有限策略评估，可能存在高方差问题。论文因此引入了一个基于动作影响的、与奖励无关的启发式<strong>质量指标</strong> $\Psi_{\text{qual}}$（图4），它衡量演示对策略访问状态的覆盖度。论文分析了在何种条件下，结合性能影响和质量指标能增强整体筛选效果。</p>
<h2 id="实验与结果">实验与结果</h2>
<p>实验在模拟的<strong>RoboMimic</strong>基准测试（Can, Square, Lift, Tool Hang任务）和真实机器人硬件（桌面操作任务）上进行。对比的基线方法包括：<strong>随机选择</strong>；基于质量的筛选方法，如<strong>DemoRank</strong>（基于互信息）和<strong>LfD</strong>（基于不确定性）；基于性能的方法，如<strong>DataMIL</strong>（使用数据模型）；以及<strong>全部数据</strong>训练。</p>
<p><img src="https://arxiv.org/html/2506.19121v2/x5.png" alt="模拟结果-成功率"></p>
<blockquote>
<p><strong>图5</strong>：在RoboMimic的Can任务上，使用不同比例筛选后的数据训练扩散策略的成功率。CUPID（性能影响）在几乎所有数据比例下都优于基线，使用不到33%的数据即可达到与全数据集相当或更优的性能。</p>
</blockquote>
<p>关键实验结果：在模拟实验中，使用CUPID（性能影响）筛选出的数据子集训练的策略，其性能显著优于基线。例如，在RoboMimic的Can任务上，使用仅30%经CUPID筛选的数据训练的扩散策略，成功率超过85%，与使用全数据（100%）训练的基线性能相当甚至更优（图5）。在数据选择任务中，CUPID也能从新收集的数据中有效地选择出最能提升性能的演示。</p>
<p><img src="https://arxiv.org/html/2506.19121v2/x6.png" alt="硬件结果-成功序列"></p>
<blockquote>
<p><strong>图6</strong>：硬件实验定性结果。CUPID筛选出的数据训练的策略（右列）能够成功完成套圈任务，而使用全数据或随机筛选数据训练的策略（左列和中列）会因学习到虚假关联（如总是触摸底座）而失败。</p>
</blockquote>
<p>硬件实验进一步验证了CUPID的有效性：1）<strong>识别分布偏移下的鲁棒策略</strong>：在测试环境与训练数据存在差异时，CUPID筛选数据训练的策略更鲁棒。2）<strong>隔离虚假相关性</strong>：如图6所示，当演示数据中包含与任务成功无关的伪模式（如总是触摸物体底座）时，CUPID能够筛选掉这些包含伪模式的演示，使策略学会正确的套圈动作，而使用全数据或随机筛选数据的策略则失败了。3）<strong>增强通用策略的后训练</strong>：CUPID可用于从一个大型多任务数据集中为特定任务选择最相关的数据，从而高效提升通用策略在特定任务上的性能。</p>
<p><img src="https://arxiv.org/html/2506.19121v2/x7.png" alt="消融实验"></p>
<blockquote>
<p><strong>图7</strong>：消融研究展示了性能影响（PI）和质量指标（QI）在不同数据筛选比例下的贡献。在数据量较少时，结合两者（CUPID）效果最好；当有足够评估轨迹时，性能影响本身已足够优秀。</p>
</blockquote>
<p>消融实验（图7）总结了各组件贡献：<strong>性能影响（PI）</strong> 是核心贡献，它直接关联了数据与闭环回报。<strong>质量指标（QI）</strong> 在策略评估轨迹数量有限（$m$ 较小）、导致性能影响估计方差较高时，能提供有价值的补充信号。两者结合（CUPID）在多数情况下达到最佳效果，特别是在数据筛选比例较低时。</p>
<h2 id="总结与启发">总结与启发</h2>
<p>本文的核心贡献在于：1）将机器人数据筛选形式化为一个根据演示对策略下游性能影响进行估值的问题；2）提出了CUPID方法，通过将影响函数与策略梯度理论结合，首次实现了对模仿学习策略闭环性能影响的有效估计，并支持数据过滤和选择两种关键操作；3）实证分析了基于性能的影响指标与基于任务无关的质量指标整合的优劣条件，为实际应用提供了指导。</p>
<p>论文提到的局限性包括：方法需要收集策略的在线评估轨迹，这引入了额外成本；性能影响的估计基于一阶近似和有限的策略采样，可能在高维复杂任务中存在偏差或方差。</p>
<p>本工作对后续研究的启示在于：它为数据驱动的策略调试和高效数据利用提供了一个可解释的理论工具和实践方法。其核心思想——通过建立训练数据与最终决策结果之间的因果联系来指导数据管理——可推广至更广泛的序列决策问题。展示的在分布偏移、虚假相关性识别等方面的潜力，也预示着其在提高模仿学习策略的鲁棒性和可解释性方面有广阔的应用前景。</p>

      </section>
      <section class="detail-tldr">
        <h2>💡 一句话总结</h2>
        <p>本文提出CUPID方法，旨在解决机器人模仿学习中难以量化单个演示数据对闭环策略性能影响的核心问题。该方法基于影响函数理论，通过估计每个训练演示对策略预期回报的影响，实现对数据的排名与筛选，具体包括过滤有害数据和优选新轨迹。实验表明，在模拟RoboMimic基准测试中，使用经CUPID筛选后不足33%的数据训练出的扩散策略即可达到最优性能，硬件实验也观察到类似的性能提升，并能有效识别分布偏移下的鲁棒策略。</p>
      </section>
      <div class="detail-actions">
        <a href="http://arxiv.org/abs/2506.19121" target="_blank" rel="noreferrer" class="btn">查看 arXiv 原文</a>
        <a href="../index.html" class="btn btn-outline">返回列表</a>
      </div>
    </article>
  </main>
  <footer class="site-footer">
    <span>数据抓取来源于 Robotics arXiv Daily</span>
    <span>本页由 GitHub Actions 定时更新</span>
  </footer>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
</body>
</html>