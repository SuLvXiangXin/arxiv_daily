<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Influence Functions for Data Attribution in Linear System Identification and LQR Control - Robotics arXiv Daily</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="../assets/styles.css"/>
  <link rel="stylesheet" href="../assets/detail.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/>
</head>
<body>
  <div class="bg-orbit"></div>
  <header class="site-header">
    <div class="brand">
      <a href="../index.html" class="back-link">← 返回列表</a>
    </div>
  </header>
  <main class="detail-main">
    <article class="detail-card">
      <span class="detail-category">Manipulation</span>
      <h1>Influence Functions for Data Attribution in Linear System Identification and LQR Control</h1>
      <div class="detail-meta">
        <span>arXiv: <a href="http://arxiv.org/abs/2506.11293" target="_blank" rel="noreferrer">2506.11293</a></span>
        <span>作者: Dongmei Chen Team</span>
        <span>日期: 2025-06-12</span>
      </div>
      <section class="detail-body">
        <h2>📝 详细解读</h2>
        <h2 id="研究背景与动机">研究背景与动机</h2>
<p>在机器学习和机器人控制领域，理解单个训练数据点的影响对于开发可靠的系统至关重要。目前，评估数据重要性的主流方法是留一法重训练，即移除一个数据点后重新训练模型以观察其影响。然而，对于大规模数据集和复杂模型，这种方法计算成本高昂，难以实现。本文针对这一具体痛点，即如何高效地量化单个训练轨迹对学习到的系统动态模型以及基于该模型设计的下游控制器性能的影响，提出了使用影响函数进行数据归因的新视角。本文的核心思路是：借鉴机器学习中的影响函数概念，通过模型参数关于损失的导数来近似移除数据点的影响，避免了昂贵的重训练，并首次将这种分析扩展到控制理论中，追踪数据影响从动态模型学习到线性二次型调节器控制器性能的完整链条。</p>
<h2 id="方法详解">方法详解</h2>
<p>本文提出的框架旨在高效评估移除单个训练轨迹对学习型控制系统的影响。整体流程分为两个阶段：首先，从轨迹数据集 $\mathcal{D}$ 中学习一个参数化的线性动态模型 $f_{\hat{\bm{\theta}}}$；其次，基于学习到的模型设计一个LQR控制器，并计算其性能成本 $J(\hat{\bm{\theta}})$。影响分析的目标是近似估计移除一条轨迹 $\tau_k$ 后，模型预测损失和LQR控制成本的变化。</p>
<p><img src="https://arxiv.org/html/2506.11293v1/extracted/6537624/e6bf55501de86482688735e9a595373.png" alt="方法框架"></p>
<blockquote>
<p><strong>图1</strong>：所提出的两阶段影响分析框架概览。第一阶段（IF1）评估移除训练轨迹 $\tau_k$ 对学习到的动态模型参数 $\hat{\bm{\theta}}$ 及其预测损失的影响。第二阶段（IF2）评估由于 $\hat{\bm{\theta}}$ 变化而导致的LQR控制成本 $J(\hat{\bm{\theta}})$ 的变化。虚线表示近似的影响计算路径，避免了实线所示的昂贵重训练过程。</p>
</blockquote>
<p>核心模块是两个专门推导的影响函数：</p>
<ol>
<li><strong>IF1（动态层影响）</strong>：用于估计移除轨迹 $\tau_k$ 对学习模型预测精度的影响。其推导基于标准影响函数理论。首先，参数的变化 $\Delta \bm{\theta} = \hat{\bm{\theta}}<em>{\setminus k} - \hat{\bm{\theta}}$ 可通过牛顿近似得到：$\Delta \bm{\theta} \approx \bm{H}^{-1} \nabla</em>{\bm{\theta}} \mathcal{L}<em>k(\hat{\bm{\theta}})$，其中 $\bm{H} = \nabla</em>{\bm{\theta}}^2 L(\hat{\bm{\theta}}, \mathcal{D})$ 是总损失的海森矩阵，$\mathcal{L}<em>k$ 是轨迹 $\tau_k$ 的损失。接着，模型在某个测试点 $z</em>{\text{test}}$ 上预测损失的变化，可以通过链式法则近似为 $\mathcal{I}<em>1(\tau_k, z</em>{\text{test}}) = -\nabla_{\bm{\theta}} \ell(z_{\text{test}}, \hat{\bm{\theta}})^T \bm{H}^{-1} \nabla_{\bm{\theta}} \mathcal{L}_k(\hat{\bm{\theta}})$。对于线性模型和平方损失，梯度和海森矩阵有解析形式，使得计算高效。</li>
<li><strong>IF2（控制层影响）</strong>：用于量化移除轨迹 $\tau_k$ 通过影响模型参数 $\hat{\bm{\theta}}$，最终对LQR控制器性能成本 $J(\hat{\bm{\theta}})$ 造成的影响。这是本文的关键创新。LQR成本 $J(\hat{\bm{\theta}}) = \bm{x}<em>0^T \bm{P}(\hat{\bm{\theta}}) \bm{x}<em>0$，其中 $\bm{P}(\hat{\bm{\theta}})$ 是离散代数Riccati方程的解。因此，影响需要从参数 $\bm{\theta}$ 通过DARE传播到成本 $J$。IF2的推导同样从参数变化 $\Delta \bm{\theta}$ 开始，然后应用一阶泰勒展开：$\mathcal{I}<em>2(\tau_k) = J(\hat{\bm{\theta}}</em>{\setminus k}) - J(\hat{\bm{\theta}}) \approx \nabla</em>{\bm{\theta}} J(\hat{\bm{\theta}})^T \Delta \bm{\theta}$。将 $\Delta \bm{\theta}$ 的近似代入，得到 $\mathcal{I}<em>2(\tau_k) \approx -\nabla</em>{\bm{\theta}} J(\hat{\bm{\theta}})^T \bm{H}^{-1} \nabla</em>{\bm{\theta}} \mathcal{L}<em>k(\hat{\bm{\theta}})$。关键步骤是计算 $\nabla</em>{\bm{\theta}} J(\hat{\bm{\theta}})$，这涉及对DARE解的微分。论文利用了DARE解的隐函数微分技术，推导出 $\nabla_{\bm{\theta}} J(\hat{\bm{\theta}})$ 可以通过求解一个与DARE维度相同的线性矩阵方程（李雅普诺夫方程）来高效计算。</li>
</ol>
<p>与现有方法相比，本文的创新点具体体现在：1) 首次将影响函数系统性地引入控制系统中的数据归因问题；2) 定义了专门针对动态模型学习（IF1）和最优控制性能（IF2）的两层影响度量；3) 通过推导 $\nabla_{\bm{\theta}} J(\hat{\bm{\theta}})$，实现了影响从模型参数到基于模型的控制器性能的链式传播，建立了数据与闭环控制性能之间的直接、可计算的联系。</p>
<h2 id="实验与结果">实验与结果</h2>
<p>实验在模拟的线性动态系统上进行，这些系统类似于机器人操纵器：一个2维状态的单连杆机械臂和一个4维状态的双连杆机械臂。数据集 $\mathcal{D}$ 包含通过随机控制输入激励系统收集的多个轨迹。基准方法是计算“真实”影响，即实际执行留一法重训练，得到新的参数 $\hat{\bm{\theta}}<em>{\setminus k}$ 和成本 $J(\hat{\bm{\theta}}</em>{\setminus k})$，然后计算与全数据集结果的差值。本文提出的IF1和IF2作为高效近似方法与之对比。</p>
<p>关键实验结果如下：IF1预测的模型预测损失变化与真实值之间表现出极强的正相关性。在单连杆系统上，相关性高达0.9271；在更复杂的双连杆系统上，相关性为0.8273。IF2预测的LQR成本变化与真实值之间也显示出显著的正相关性，在单连杆和双连杆系统上分别达到0.7584和0.7562。这些数值表明所提框架在高效近似数据影响方面的有效性。</p>
<p><img src="https://arxiv.org/html/2506.11293v1/extracted/6537624/e0e4ece72f257b0169f70c18b8fa8cd.png" alt="相关性结果"></p>
<blockquote>
<p><strong>图2</strong>：IF1和IF2预测的影响值与通过重训练计算得到的真实影响值之间的相关性散点图。左图为单连杆臂结果，右图为双连杆臂结果。点越靠近对角线y=x，预测越准确。IF1和IF2均显示出与真实值强烈的正相关关系。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2506.11293v1/extracted/6537624/f2df944780548489157ef3b1a4dc9ae.png" alt="消融实验"></p>
<blockquote>
<p><strong>图3</strong>：消融研究结果。该图展示了在计算IF2时，使用精确的 $\nabla_{\bm{\theta}} J$（通过论文推导的隐函数微分方法）与使用有限差分近似 $\nabla_{\bm{\theta}} J$ 所得到的影响预测与真实值之间的相关性对比。结果显示，精确方法（红色）的相关性显著高于有限差分方法（蓝色），验证了所推导梯度公式的正确性和优越性。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2506.11293v1/extracted/6537624/df1c9d5438f3fc35eea1baa32e1ff49.png" alt="定性结果"></p>
<blockquote>
<p><strong>图4</strong>：定性分析示例。左图展示了数据集中所有轨迹根据IF2计算出的影响值排序。右图展示了影响值最高（最有害）和最低（最有益）的轨迹对应的开环状态演化。有害轨迹表现出不稳定的发散行为，而有裨益的轨迹则保持稳定，这直观地解释了它们对学习稳定LQR控制器的影响差异。</p>
</blockquote>
<p>消融实验总结了关键组件的贡献：论文比较了计算 $\nabla_{\bm{\theta}} J$ 时，使用推导的隐函数微分方法（精确）与使用有限差分近似（近似）的效果。结果显示，精确方法能获得显著更高的预测相关性（例如在双连杆案例中，精确法相关性为0.756，有限差分为0.514），这验证了所推导的通过DARE传播梯度的理论方法的必要性和正确性，它是IF2高效且准确的核心。</p>
<h2 id="总结与启发">总结与启发</h2>
<p>本文的核心贡献可概括为三点：1) 提出了首个用于线性系统识别和LQR控制中数据归因的影响函数框架，定义了动态层（IF1）和控制层（IF2）两层影响度量；2) 通过推导控制成本 $J(\hat{\bm{\theta}})$ 关于模型参数 $\bm{\theta}$ 的梯度（涉及DARE解的微分），建立了从训练数据到闭环控制性能的定量联系；3) 在模拟的机器人系统上进行了实证验证，表明IF1和IF2的预测与真实重训练结果高度相关，证明了框架的实用性和高效性。</p>
<p>论文自身提到的局限性主要包括：当前分析基于线性动态模型和LQR控制器，对于非线性模型和更复杂的控制器，影响函数的推导和计算可能更具挑战性；影响函数计算依赖于海森矩阵 $\bm{H}$ 的可逆性以及一阶近似假设，在模型高度非线性或数据点影响巨大时，近似精度可能下降。</p>
<p>本文的成果对后续研究有多方面启示：所提出的框架可以扩展到其他基于模型的控制器设计（如模型预测控制）；可以探索将影响分析用于主动学习或数据清洗，以高效地识别并移除有害数据或增补有益数据；此外，如何将方法应用于部分可观测系统或更复杂的神经网络动态模型，是未来值得探索的方向。</p>

      </section>
      <section class="detail-tldr">
        <h2>💡 一句话总结</h2>
        <p>本文针对基于机器学习的控制系统中，传统方法计算成本高、难以高效评估单个训练数据影响的问题，提出使用影响函数框架进行数据归因。核心方法包括IF1（动态级影响，估计移除训练轨迹对线性动态模型预测准确性的影响）和IF2（控制级影响，通过离散代数Riccati方程解追踪敏感性，量化对LQR控制器成本的影响）。在模拟线性系统上的实验表明，影响预测与重新训练获得的真实变化呈强正相关，验证了方法的计算可行性。</p>
      </section>
      <div class="detail-actions">
        <a href="http://arxiv.org/abs/2506.11293" target="_blank" rel="noreferrer" class="btn">查看 arXiv 原文</a>
        <a href="../index.html" class="btn btn-outline">返回列表</a>
      </div>
    </article>
  </main>
  <footer class="site-footer">
    <span>数据抓取来源于 Robotics arXiv Daily</span>
    <span>本页由 GitHub Actions 定时更新</span>
  </footer>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
</body>
</html>