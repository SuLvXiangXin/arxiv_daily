<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Simultaneous Calibration of Noise Covariance and Kinematics for State Estimation of Legged Robots via Bi-level Optimization - Robotics arXiv Daily</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="../assets/styles.css"/>
  <link rel="stylesheet" href="../assets/detail.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/>
</head>
<body>
  <div class="bg-orbit"></div>
  <header class="site-header">
    <div class="brand">
      <a href="../index.html" class="back-link">← 返回列表</a>
    </div>
  </header>
  <main class="detail-main">
    <article class="detail-card">
      <span class="detail-category">Robotics (cs.RO)</span>
      <h1>Simultaneous Calibration of Noise Covariance and Kinematics for State Estimation of Legged Robots via Bi-level Optimization</h1>
      <div class="detail-meta">
        <span>arXiv: <a href="http://arxiv.org/abs/2510.11539" target="_blank" rel="noreferrer">2510.11539</a></span>
        <span>作者: Cheng, Denglin, Kang, Jiarong, Xiong, Xiaobin</span>
        <span>日期: 2025/10/13</span>
      </div>
      <section class="detail-body">
        <h2>📝 详细解读</h2>
        <h2 id="研究背景与动机">研究背景与动机</h2>
<p>腿式机器人的状态估计是其自主运行的基础。目前主流方法包括扩展卡尔曼滤波（EKF）及其变体（如利用SE(3)不变性的EKF），以及基于因子图或滑动窗口的优化方法（如移动水平估计MHE）。这些方法的一个关键局限性在于对过程噪声和测量噪声协方差矩阵的设定依赖：这些协方差矩阵通常难以准确获得，实践中严重依赖耗时且启发式的手动调整，容易导致估计器次优或不一致。该问题在具有复杂混合动力学、多模态传感器和非线性特性的高动态腿式机器人上尤为突出，运动学不确定性会进一步降低估计的精度与稳定性。</p>
<p>本文针对噪声协方差矩阵与运动学参数难以准确设定的具体痛点，提出了一个<strong>双级优化</strong>的新视角，将状态估计、传感器与运动学校准统一到一个原则性的、数据驱动的框架中。本文的核心思路是：将待校准的协方差矩阵和运动学参数作为上层优化的变量，下层则基于这些参数运行一个完整信息估计器（MAP），并通过微分穿过估计器，直接根据估计轨迹与地面真值之间的误差来优化上层参数，从而实现自动、联合的校准。</p>
<h2 id="方法详解">方法详解</h2>
<p>本文提出的方法是一个双级优化框架，旨在联合校准噪声协方差矩阵和运动学参数。上层优化以校准参数为变量，最小化估计状态与地面真值之间的损失；下层优化则固定上层参数，求解一个最大后验概率状态估计问题。</p>
<p><img src="https://i.imgur.com/LtKbK2h.png" alt="方法总览"></p>
<blockquote>
<p><strong>图1</strong>：方法整体框架及其在四足机器人上的应用示意。上层优化调整协方差参数和运动学偏移，下层则基于这些参数执行状态估计（MAP），估计结果与地面真值比较后产生的误差梯度被用于更新上层参数。</p>
</blockquote>
<p><strong>整体流程</strong>：给定传感器数据序列和对应的地面真值轨迹，算法迭代执行：1) 根据当前校准参数𝜽，求解下层MAP问题，得到状态估计轨迹𝐱̂ (𝜽)；2) 计算估计轨迹与地面真值𝐱_GT之间的损失ℒ及其对参数𝜽的梯度∇𝜽ℒ；3) 利用梯度信息，在约束集𝒞内更新参数𝜽。此过程重复直至收敛。</p>
<p><strong>核心模块与技术细节</strong>：</p>
<ol>
<li><strong>参数化与约束集𝒞</strong>：待校准的参数向量𝜽包括三部分：协方差参数𝜽_cov、足端运动学偏移𝜽_foot和躯干标记点偏移𝜽_base。其中，协方差参数通过对协方差矩阵的上三角部分（包括对角线）进行向量化得到。为确保物理和统计可行性，优化约束集𝒞要求所有参数有界，且每个协方差块必须保持对称正定。</li>
<li><strong>下层MAP估计器</strong>：采用完整信息估计（FIE）公式，在给定参数𝜽下，优化目标为公式(4)，包含先验误差、过程噪声误差和测量噪声误差的加权平方和。测量模型特别考虑了运动学不确定性：真实的足端位置由名义位置加上一个在连杆坐标系中表达的恒定偏移𝜽_foot,j经旋转后得到（公式6）。测量噪声协方差𝐑_k通过传感器原始噪声𝚺_η经由雅可比矩阵𝐆_k（公式3）传播到任务空间，并附加一个𝐑_add项来捕获未建模的运动学校准误差。</li>
<li><strong>上层损失与优化</strong>：上层损失函数ℒ衡量估计轨迹与地面真值（位姿、速度）的偏差。优化采用自适应Frank-Wolfe算法，其关键步骤是计算损失对参数𝜽的梯度。由于下层估计器𝐱̂ (𝜽)是上层优化变量的隐函数，梯度计算需通过下层优化问题的Karush-Kuhn-Tucker条件进行微分得到，从而实现“微分穿过估计器”，将轨迹级的误差直接反向传播给校准参数。</li>
</ol>
<p><strong>创新点</strong>：与现有方法（如手动调参、EM算法或独立的传感器校准）相比，本文的创新性主要体现在：1) <strong>联合校准</strong>：在一个统一的框架内同时优化噪声协方差和运动学参数，而非解耦处理；2) <strong>估计器回路中的优化</strong>：通过双级优化和微分技术，以提升最终状态估计轨迹的精度为目标直接优化校准参数；3) <strong>物理一致的参数化</strong>：对协方差矩阵施加正定约束，对运动学偏移进行几何意义的参数化，保证校准结果的物理合理性。</p>
<p><img src="https://i.imgur.com/6W6pOQe.png" alt="传感配置"></p>
<blockquote>
<p><strong>图2</strong>：实验中使用的腿式机器人平台及其常见传感能力示意图：Unitree Robotics的Go1四足机器人和G1人形机器人。</p>
</blockquote>
<h2 id="实验与结果">实验与结果</h2>
<p><strong>实验设置</strong>：方法在两种腿式机器人平台上进行验证：Unitree Go1四足机器人和Unitree G1人形机器人。实验在配备Vicon运动捕捉系统的室内进行，以提供躯干位姿和速度的地面真值。机器人执行了多种动态运动任务（如小跑、跳跃、行走）。</p>
<p><strong>对比基线</strong>：主要对比了<strong>手动调优</strong>的基线估计器。对于四足机器人，对比了基于经典EKF和不变性EKF（InEKF）的手动调参版本。对于人形机器人，对比了手动调参的移动水平估计器（MHE）。</p>
<p><strong>关键实验结果</strong>：</p>
<ul>
<li><strong>估计精度提升</strong>：经过所提方法校准后，估计器精度显著提升。对于四足机器人，与手动调优的InEKF相比，位置估计均方根误差（RMSE）降低了**68%<strong>，速度估计RMSE降低了</strong>74%<strong>。对于人形机器人，与手动调优的MHE相比，位置RMSE降低了</strong>66%<strong>，速度RMSE降低了</strong>79%**。</li>
<li><strong>不确定性校准改善</strong>：经过校准的估计器输出的不确定性（以估计误差的归一化新息平方NIS衡量）与理论卡方分布更加吻合，表明估计的一致性得到改善。而手动调参基线的不确定性往往校准不足或过度。</li>
</ul>
<p><img src="https://i.imgur.com/9WlFq0B.png" alt="误差对比"></p>
<blockquote>
<p><strong>图3</strong>：四足机器人实验的轨迹误差对比。左图：校准后的InEKF与手动调参InEKF和经典EKF的位置、速度误差对比，显示校准后误差显著降低。右图：位置误差的时序曲线，校准后的估计（蓝色）更贴近地面真值（黑色）。</p>
</blockquote>
<p><img src="https://i.imgur.com/1jLdGvY.png" alt="不确定性校准"></p>
<blockquote>
<p><strong>图4</strong>：不确定性校准评估。左图：四足机器人速度估计的归一化新息平方（NIS）统计直方图与理论卡方分布对比，校准后的结果（蓝色）匹配更好。右图：人形机器人位置估计的NIS统计，同样显示校准后的一致性更优。</p>
</blockquote>
<p><strong>消融实验</strong>：论文通过消融实验分析了各校准组件的贡献。结果表明：1) <strong>联合校准所有参数</strong>（协方差+运动学）能取得最佳性能；2) <strong>仅校准噪声协方差</strong>（固定运动学）也能带来显著提升，但不如联合校准；3) <strong>仅校准运动学参数</strong>（固定协方差）有一定帮助，但提升有限，凸显了准确噪声模型的重要性。</p>
<h2 id="总结与启发">总结与启发</h2>
<p><strong>核心贡献</strong>：</p>
<ol>
<li>提出了一个<strong>双级优化框架</strong>，用于腿式机器人状态估计中噪声协方差与运动学参数的<strong>同时校准</strong>，实现了从手动调参到自动、数据驱动校准的转变。</li>
<li>方法具有<strong>原则性和通用性</strong>：通过微分穿过估计器优化轨迹级目标，并利用物理约束的参数化，可应用于不同的估计器（EKF、MHE）和不同的机器人平台（四足、人形）。</li>
<li>在真实机器人平台上进行了<strong>全面验证</strong>，结果表明校准后的参数物理可信，并显著提升了估计精度和不确定性校准的一致性。</li>
</ol>
<p><strong>局限性</strong>：论文提及的局限性主要包括：1) 方法需要<strong>地面真值数据</strong>进行监督校准；2) 采用完整信息估计（FIE）作为下层估计器，虽然适用于离线校准，但其计算复杂度随轨迹长度增长，<strong>在线实时应用</strong>仍需结合滑动窗口等方法。</p>
<p><strong>对后续研究的启示</strong>：</p>
<ol>
<li><strong>校准范式的转变</strong>：为机器人状态估计中的模型参数校准提供了一个强大且通用的自动化范式，可扩展至更复杂的传感器模型或动力学参数校准。</li>
<li><strong>微分优化与估计的结合</strong>：展示了通过微分技术将优化问题与传统估计器紧密结合的有效性，为联合优化设计估计器与控制律等方向提供了思路。</li>
<li><strong>迈向在线自适应</strong>：当前工作侧重离线校准，未来可探索基于滑动窗口的在线自适应版本，使机器人能在任务执行过程中持续优化其估计模型。</li>
</ol>

      </section>
      <section class="detail-tldr">
        <h2>💡 一句话总结</h2>
        <p>本文针对腿足机器人状态估计中噪声协方差与运动学参数难以准确设定的核心问题，提出一种基于双层优化的联合校准框架。该方法采用双层结构：上层将噪声协方差与模型参数作为优化变量，下层执行全信息估计器，并通过微分估计器实现轨迹级目标的直接优化，从而将状态估计、传感器与运动学校准统一于数据驱动框架。在四足与人形机器人上的实验表明，相比手动调参基线，该方法显著提升了估计精度与不确定性校准效果。</p>
      </section>
      <div class="detail-actions">
        <a href="http://arxiv.org/abs/2510.11539" target="_blank" rel="noreferrer" class="btn">查看 arXiv 原文</a>
        <a href="../index.html" class="btn btn-outline">返回列表</a>
      </div>
    </article>
  </main>
  <footer class="site-footer">
    <span>数据来源：<a href="https://jiangranlv.github.io/robotics_arXiv_daily/" target="_blank">Robotics arXiv Daily</a></span>
    <span>由 GitHub Actions 自动更新 · AI 摘要仅供参考</span>
  </footer>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
</body>
</html>