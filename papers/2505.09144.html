<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Latent Theory of Mind: A Decentralized Diffusion Architecture for Cooperative Manipulation - Robotics arXiv Daily</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="../assets/styles.css"/>
  <link rel="stylesheet" href="../assets/detail.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/>
</head>
<body>
  <div class="bg-orbit"></div>
  <header class="site-header">
    <div class="brand">
      <a href="../index.html" class="back-link">← 返回列表</a>
    </div>
  </header>
  <main class="detail-main">
    <article class="detail-card">
      <span class="detail-category">Robotics (cs.RO)</span>
      <h1>Latent Theory of Mind: A Decentralized Diffusion Architecture for Cooperative Manipulation</h1>
      <div class="detail-meta">
        <span>arXiv: <a href="http://arxiv.org/abs/2505.09144" target="_blank" rel="noreferrer">2505.09144</a></span>
        <span>作者: He, Chengyang, Camps, Gadiel Sznaier, Liu, Xu, Schwager, Mac, Sartoretti, Guillaume</span>
        <span>日期: 2025/05/14</span>
      </div>
      <section class="detail-body">
        <h2>📝 详细解读</h2>
        <h2 id="研究背景与动机">研究背景与动机</h2>
<p>目前，扩散策略（Diffusion Policy）是机器人臂操作领域最先进的解决方案之一，能够生成平滑、多模态、长时域的动作轨迹。然而，现有方法主要采用集中式框架，即一个策略控制所有智能体（如双臂）。这种框架存在扩展性差、训练困难以及对系统故障敏感等固有问题。与此同时，分散式框架因其鲁棒性和灵活性而受到关注，但面临核心挑战：每个机器人臂仅拥有部分观察，且可能受域偏移影响，难以维持全局一致性，微小的不一致就容易导致精密的协作任务失败。</p>
<p>本文针对分散式协作操作中，如何使拥有不同感知流的智能体形成并维持一个全局一致且富有表达力的共识表示这一具体痛点，提出了一个新视角。其核心思路是：为每个智能体维护两种潜在表示——一个特定于机器人自身的“自我嵌入”（ego embedding）和一个旨在跨智能体保持一致的“共识嵌入”（consensus embedding），并借鉴层论（Sheaf Theory）和心智理论（Theory of Mind）来约束共识嵌入的训练，使其既数值一致又信息丰富，从而在无需显式通信或仅需少量通信的情况下实现高效协作。</p>
<h2 id="方法详解">方法详解</h2>
<p>LatentToM是一个为N个独立机械臂设计的分散式扩散策略架构，训练时可集中进行，执行时可完全分散。每个机械臂拥有自己的神经网络。论文以双臂系统为例进行说明。</p>
<p><img src="https://arxiv.org/html/2505.09144v1/extracted/6437500/figures/overview.png" alt="方法框架"></p>
<blockquote>
<p><strong>图1</strong>：LatentToM方法整体框架。系统包含两个机械臂（红、绿），各有一个末端执行器摄像头（红/绿色视野）和一个共享的第三方视角摄像头（灰色视野）。每个臂的观察被明确划分为自我观察（末端图像和位姿）和共识观察（第三方视角），分别编码为自我嵌入和共识嵌入。训练时，通过层论一致性损失、心智理论损失和方向性共识损失来协调两个臂的共识嵌入。推理时，可通过隐式观察或显式共享共识嵌入来实现协作。</p>
</blockquote>
<p><strong>整体流程与核心模块</strong>：每个机械臂（节点u）的观察 (o_u) 被划分为 (o_u^{ego})（末端图像和位姿）和 (o_u^{con})（第三方视角图像）。分别通过视觉编码器 (\phi_u^{ego}) 和 (\phi_u^{con}) 编码为自我嵌入 (h_u^{ego}) 和共识嵌入 (h_u^{con})。完整的嵌入 (h_u = [h_u^{ego}, h_u^{con}]) 随后输入到一个扩散策略网络中，以生成该臂的动作轨迹。协作的关键在于使两个臂的共识嵌入 (h_u^{con}) 和 (h_v^{con}) 对齐并富含信息。这是通过三个辅助损失函数实现的：</p>
<ol>
<li><p><strong>基于层论的数值一致性损失（(\mathcal{L}_{nc})）</strong>：将双臂系统形式化为图 (\mathcal{G}) 上的一个层（Sheaf）(\mathcal{F})，每个节点的向量空间即其共识嵌入 (h_u^{con})。对于连接节点u和v的边e，定义限制映射 (\rho_{u \rightarrow e})。该损失强制两个节点在共识空间上数值一致：<br>(\mathcal{L}<em>{nc} = \sum</em>{e=(u,v)\in\mathcal{E}} ||\rho_{u \rightarrow e}(h_u^{con}) - \rho_{v \rightarrow e}(h_v^{con})||_2^2)<br>最小化此损失相当于最小化层的一阶上同调，促使系统逼近一个全局截面，即共识嵌入达到全局数值一致性。</p>
</li>
<li><p><strong>心智理论损失（(\mathcal{L}_{tom})）</strong>：为防止仅追求数值一致导致共识嵌入坍缩成平凡解（如常数向量），损失其表达力，本文引入心智理论约束。要求每个臂u利用自己的共识嵌入 (h_u^{con})，通过一个预测函数 (\psi_{u \rightarrow v})（ToM预测器）去推断另一臂v的自我嵌入 (h_v^{ego})。损失定义为预测值与真实值之间的差距：<br>(\mathcal{L}<em>{tom} = \sum</em>{(u,v)\in\mathcal{E}} ||h_v^{ego} - \psi_{u \rightarrow v}(h_u^{con})||_2^2 + (v \leftrightarrow u))<br>这迫使共识嵌入必须携带足够丰富的全局语义信息，才能成功预测他者的自我状态。</p>
</li>
<li><p><strong>方向性共识损失（(\mathcal{L}_{conf})）</strong>：考虑到现实中不同臂的观察质量可能不同（如视野好坏），引入置信度预测器为每个共识嵌入 (h_u^{con}) 生成一个置信度分数 (c_u \in [0,1])。该损失实现非对称对齐（单向一致性），即低置信度的嵌入应向高置信度的嵌入对齐：<br>(\mathcal{L}<em>{conf} = (1+|\Delta c|) \cdot [\mathbf{1}</em>{c_u \geq c_v} \cdot ||h_v^{con} - h_u^{con}|| + \mathbf{1}<em>{c_v \geq c_u} \cdot ||h_u^{con} - h_v^{con}||] + \lambda</em>{ent} \cdot [\mathcal{H}(c_u) + \mathcal{H}(c_v)])<br>其中，(\Delta c = c_u - c_v)，(\mathcal{H}) 是二元熵。第一部分根据置信度差异加权对齐误差，差异越大惩罚越重；第二部分是熵正则项，防止置信度在训练早期过早收敛到极端值，提升稳定性。</p>
</li>
</ol>
<p>总训练损失为上述三项的加权和：(\mathcal{L}<em>{tot} = \alpha\mathcal{L}</em>{nc} + \beta\mathcal{L}<em>{tom} + \gamma\mathcal{L}</em>{conf})，与扩散模型原有的动作预测损失共同优化。</p>
<p><strong>推理模式</strong>：训练完成后，系统可在两种模式下运行：</p>
<ul>
<li><strong>完全分散式（无通信）</strong>：每个臂仅依赖自身的本地观察（(o_u^{ego}) 和 (o_u^{con})）生成动作和共识嵌入。协作通过观察彼此动作及其对场景的影响（隐含在后续的 (o_u^{con}) 中）来隐式实现。</li>
<li><strong>通信辅助式</strong>：每个推理步骤前，进行一次通信，交换彼此的共识嵌入 (h_u^{con})，并使用层拉普拉斯算子（Sheaf Laplacian）进行在线对齐，然后再各自生成动作。</li>
</ul>
<p><strong>创新点</strong>：与现有分散式方法相比，LatentToM的创新在于：1) 明确划分并维护自我与共识两种嵌入；2) 首次将层论引入分散式策略训练，为共识一致性提供了严格的数学框架和损失函数；3) 结合心智理论约束防止表示坍缩；4) 提出方向性共识机制处理观察质量不均的情况。</p>
<h2 id="实验与结果">实验与结果</h2>
<p><strong>实验设置</strong>：在真实机器人双臂平台上进行测试。使用了两个协作操作基准任务：1) <strong>协同拾放</strong>：将一个立方体从桌上一处移至另一处；2) <strong>长时域堆叠</strong>：将两个立方体堆叠起来。</p>
<p><img src="https://arxiv.org/html/2505.09144v1/extracted/6437500/figures/tasks.png" alt="任务示意图"></p>
<blockquote>
<p><strong>图2</strong>：两个实验任务示意图。左图为协同拾放任务，右图为长时域堆叠任务。</p>
</blockquote>
<p><strong>对比方法</strong>：</p>
<ul>
<li><strong>Centralized Diffusion</strong>：最先进的集中式扩散策略，作为性能上限参考。</li>
<li><strong>Naive Decentralized Diffusion</strong>：朴素分散式基线，两个臂独立训练扩散策略，无任何协调机制。</li>
<li>**LatentToM (Ours)**：本文提出的方法。</li>
<li>**LatentToM (w/ comm.)**：本文方法在推理时使用通信辅助模式。</li>
</ul>
<p><strong>关键定量结果</strong>：</p>
<p><img src="https://arxiv.org/html/2505.09144v1/extracted/6437500/figures/result_task1_v2.png" alt="任务一结果"></p>
<blockquote>
<p><strong>图6</strong>：协同拾放任务的成功率对比。LatentToM（无通信）显著优于朴素分散式基线（70% vs. 30%），并与集中式方法性能相当（70% vs. 75%）。使用通信后，LatentToM性能进一步提升至80%。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2505.09144v1/extracted/6437500/figures/result_task2.png" alt="任务二结果"></p>
<blockquote>
<p><strong>图7</strong>：长时域堆叠任务的成功率对比。趋势与任务一类似，LatentToM（无通信）成功率为65%，远高于朴素分散式的20%，接近集中式的70%。通信辅助版本达到75%。</p>
</blockquote>
<p><strong>消融实验与鲁棒性分析</strong>：</p>
<p><img src="https://arxiv.org/html/2505.09144v1/extracted/6437500/figures/tompred.png" alt="消融实验"></p>
<blockquote>
<p><strong>图8</strong>：心智理论预测器的消融研究。左图显示，随着训练进行，预测器能越来越准确地从共识嵌入中推断他者的自我嵌入（误差下降）。右图显示，使用预测器（ToM）能有效防止共识嵌入坍缩（保持较高的嵌入方差），而仅使用层论损失（NC）会导致坍缩。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2505.09144v1/extracted/6437500/figures/btmOOD.png" alt="分布外泛化"></p>
<blockquote>
<p><strong>图5</strong>：分布外泛化测试。当任务设置发生变化（如物体颜色、纹理、背景改变）时，LatentToM（蓝色）相比集中式方法（橙色）表现出更好的泛化能力，成功率下降更少。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2505.09144v1/extracted/6437500/figures/btmInD.png" alt="故障鲁棒性"></p>
<blockquote>
<p><strong>图4</strong>：对临时故障或延迟的鲁棒性测试。模拟一个臂暂时“冻结”的情况。LatentToM（蓝色）由于具有分散式和基于共识的决策能力，能更好地适应这种扰动，性能下降平缓。而集中式策略（橙色）一旦“中枢”受干扰或依赖的某个视角失效，性能会急剧下降。</p>
</blockquote>
<p><strong>定性结果</strong>：</p>
<p><img src="https://arxiv.org/html/2505.09144v1/extracted/6437500/figures/top.png" alt="定性结果"></p>
<blockquote>
<p><strong>图3</strong>：协同拾放任务的定性执行序列。展示了LatentToM控制下的双臂如何协调地抓取、传递和放置物体。</p>
</blockquote>
<p><strong>消融实验总结</strong>：论文通过消融实验验证了各核心组件的贡献。心智理论约束对于防止共识嵌入坍缩、保持其信息丰富度至关重要；方向性共识机制在处理不对称观察场景时提升了鲁棒性；层论一致性损失是实现分散式协作的基础。整体方法在分布外泛化和应对智能体临时故障方面展现出显著优势。</p>
<h2 id="总结与启发">总结与启发</h2>
<p><strong>核心贡献</strong>：</p>
<ol>
<li><strong>提出了LatentToM</strong>：一个新颖的分散式扩散策略架构，通过维护自我嵌入和共识嵌入，使多智能体在无需或仅需少量显式通信的情况下实现协作操作。</li>
<li><strong>引入了层论与心智理论</strong>：首次将层论的形式化一致性约束和心智理论的信息保留约束引入分散式机器人策略训练，确保了共识表示既全局一致又富有表达力，并提出了方向性共识机制以处理观察质量差异。</li>
<li><strong>验证了分散式的优势</strong>：在真实机器人实验中，所提方法性能媲美集中式SOTA，且在泛化性和对临时故障的鲁棒性方面表现更优。</li>
</ol>
<p><strong>局限性</strong>：论文自身提到，当前方法在训练阶段仍需要集中式的第三方视角观察数据。此外，虽然执行时可分散，但策略训练本身是在中心化收集的数据上进行的。</p>
<p><strong>后续研究启示</strong>：</p>
<ol>
<li><strong>完全分散式训练</strong>：未来工作可以探索如何在没有全局第三方视角的情况下进行完全分散式的在线训练或强化学习。</li>
<li><strong>扩展至更多智能体</strong>：本文方法理论上可扩展至任意数量的智能体，未来可在更复杂的多臂或群体机器人场景中进行验证。</li>
<li><strong>动态通信学习</strong>：可以研究让智能体动态学习何时需要进行显式通信，以在性能、带宽和鲁棒性之间取得最优平衡。</li>
<li><strong>结合更高级的规划</strong>：将本方法作为底层控制器，与高层任务规划器结合，以解决更复杂、分层的协作任务。</li>
</ol>

      </section>
      <section class="detail-tldr">
        <h2>💡 一句话总结</h2>
        <p>本文提出LatentToM方法，解决多机械臂在无显式通信下的协作操作问题。核心创新是让每个智能体维护两种潜在表示：自我嵌入和共识嵌入，并基于层论设计一阶上同调损失对齐共识嵌入，结合定向共识机制实现分布式协调。硬件实验表明，该方法优于基础去中心化扩散策略，与集中式扩散策略在双手操作上性能相当，且对临时故障或延迟具有鲁棒性。</p>
      </section>
      <div class="detail-actions">
        <a href="http://arxiv.org/abs/2505.09144" target="_blank" rel="noreferrer" class="btn">查看 arXiv 原文</a>
        <a href="../index.html" class="btn btn-outline">返回列表</a>
      </div>
    </article>
  </main>
  <footer class="site-footer">
    <span>数据来源：<a href="https://jiangranlv.github.io/robotics_arXiv_daily/" target="_blank">Robotics arXiv Daily</a></span>
    <span>由 GitHub Actions 自动更新 · AI 摘要仅供参考</span>
  </footer>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
</body>
</html>