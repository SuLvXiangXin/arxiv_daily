<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Learning Accurate Whole-body Throwing with High-frequency Residual Policy and Pullback Tube Acceleration - Robotics arXiv Daily</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="../assets/styles.css"/>
  <link rel="stylesheet" href="../assets/detail.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/>
</head>
<body>
  <div class="bg-orbit"></div>
  <header class="site-header">
    <div class="brand">
      <a href="../index.html" class="back-link">← 返回列表</a>
    </div>
  </header>
  <main class="detail-main">
    <article class="detail-card">
      <span class="detail-category">Manipulation</span>
      <h1>Learning Accurate Whole-body Throwing with High-frequency Residual Policy and Pullback Tube Acceleration</h1>
      <div class="detail-meta">
        <span>arXiv: <a href="http://arxiv.org/abs/2506.16986" target="_blank" rel="noreferrer">2506.16986</a></span>
        <span>作者: Marco Hutter Team</span>
        <span>日期: 2025-06-24</span>
      </div>
      <section class="detail-body">
        <h2>📝 详细解读</h2>
        <h2 id="研究背景与动机">研究背景与动机</h2>
<p>腿式机器人执行动态、高精度的全身操控任务对于推进自动化配送、灾难响应等应用至关重要。投掷作为一种基本技能，能使机器人以超越臂展的方式操纵物体。预抓握投掷（抓取物体并在运动中释放）因能处理不规则物体和多样姿态而扩展了投掷能力，但其核心挑战在于释放时机的不确定性（如夹爪-物体交互的摩擦或形变差异）以及高度动态场景下全身末端执行器（EE）状态跟踪的准确性。</p>
<p>目前，基于学习的方法已在固定基座机械臂上展示了投掷能力，但难以扩展到移动基座系统。近期虽有腿式机器人全身投掷的工作，但缺乏详细的硬件精度报告。模型基于规划的方法虽能提供理论保证，但尚未推广到全身系统。</p>
<p>本文针对预抓握投掷中释放时机不确定和动态跟踪不准确的具体痛点，将其重新表述为全身EE速度跟踪问题。核心思路是结合强化学习训练一个名义策略来跟踪规划的EE轨迹，并引入一个高频残差策略来提升跟踪精度，以及一个基于优化的拉回管加速度模块来生成针对实时投掷误差的纠正运动指令，从而在动态条件下实现鲁棒且精确的投掷。</p>
<h2 id="方法详解">方法详解</h2>
<p>提出的投掷控制器由三个组件构成：一个基线全身EE状态跟踪策略（名义策略）、一个残差策略和一个拉回管加速度优化器模块。</p>
<p><img src="https://arxiv.org/html/2506.16986v3/x2.png" alt="控制框架"></p>
<blockquote>
<p><strong>图2</strong>：提出的控制框架。包含一个标准的全身基座投掷策略、一个残差策略和一个加速度优化器。后两个模块以与机器人状态估计相同的频率运行，为投掷运动提供高频状态反馈。部署时，控制器从AprilTag读取器获取目标位置，并计算机器人每个关节的PD目标指令。</p>
</blockquote>
<p><strong>1. 全身EE状态跟踪（名义策略）</strong><br>该策略并非端到端生成运动，而是显式地指令一个鲁棒的投掷运动，确保运动保持在物体飞行的目标流形内，以应对释放不确定性。策略在100Hz控制频率下运行，观测机器人当前状态、目标指令、当前投掷已用时间和上一时刻动作，为18个机器人关节生成PD控制目标。为提升泛化性，训练时在夹爪上随机化物体质量。奖励函数旨在最小化指定的EE位置、速度和朝向目标的跟踪误差（具体奖励项见表I）。每个投掷动作指定恒定的速度参考以简化学习过程。</p>
<p><strong>2. 高频残差策略</strong><br>名义策略训练完成后，冻结其权重，再训练一个残差策略以增强EE跟踪精度并实现有效的EE加速度跟踪。该策略以400Hz运行（与机器人状态估计频率一致），除名义策略的观测外，还观测当前控制降采样和垂直方向的EE加速度目标。其输出是机械臂关节的位置偏移量，会加到名义策略对应关节的动作输出上。训练时结合了名义策略的任务奖励（根据加速度修改位置和速度参考）以及一个最小化其动作幅度的额外奖励，以防止其行为过度偏离名义策略。训练超参数与名义策略不同（见表II）。</p>
<p><strong>3. 拉回管加速度优化器</strong><br>为应对释放时机不确定性（夹爪打开指令后，物体分离时间在50-100ms内不确定）以及跟踪误差可能导致EE在释放阶段开始时不在有效区域的问题，本文提出了<strong>拉回管加速度</strong>方法。其核心思想是：基于当前EE状态的闭环管加速度控制器会将EE状态“拉回”到<strong>后向可达管（BRT）</strong> 中，使BRT成为闭环动力系统的吸引不变集。</p>
<ul>
<li><strong>后向可达管（BRT）定义</strong>：BRT是所有最终能进入用户指定的着陆目标集 $\mathcal{X}$ 的物体飞行轨迹上状态的集合。对于仅受重力影响的抛体运动，BRT可通过飞行流图 $\Phi$ 解析描述，该流图将释放状态 $\xi_d$ 和着陆高度 $z_{land}$ 映射到水平着陆位置 $r_{land}$。</li>
<li><strong>拉回管加速度生成</strong>：该方法通过求解一个凸优化问题，实时计算所需的EE加速度 $\bm{a}<em>{tube}$。该问题以最小化预测着陆点 $r</em>{land}$ 与目标点 $r_{target}$ 的误差为目标，约束条件基于当前测量的EE状态 $(\bm{p}<em>{EE}, \bm{v}</em>{EE})$、剩余释放窗口时间 $T$、以及通过飞行流图 $\Phi$ 及其雅可比近似建立的EE状态与预测着陆点的关系，同时包含对终端速度 $\bm{v}<em>T$ 和加速度 $\bm{a}</em>{tube}$ 的物理限制。所有等式约束为线性，不等式约束为多面体，因此是凸规划，可通过CVXPYgen高效求解，平均求解时间0.4ms，可实现超过1kHz的闭环运行。</li>
</ul>
<h2 id="实验与结果">实验与结果</h2>
<p>实验在搭载ANYmal-D腿式机器人和定制7自由度机械臂的硬件平台以及仿真环境中进行验证。使用AprilTag标识目标位置。</p>
<p><strong>关键定量结果</strong>：</p>
<ol>
<li>在向6米外的目标投掷时，实现了<strong>平均0.28米的着陆误差</strong>。</li>
<li>在一项与大学生对比的研究中，系统以指定的6 m/s速度投掷，投掷3-5米外随机放置的小目标时，取得了<strong>56.8%的成功率</strong>，速度跟踪误差为0.398 m/s。相比之下，**人类的成功率仅为15.2%**。</li>
</ol>
<p><img src="https://arxiv.org/html/2506.16986v3/x1.png" alt="硬件投掷测试"></p>
<blockquote>
<p><strong>图1</strong>：机器人执行预抓握全身投掷，投掷速度和物体属性各异。(A) 一个礼物盒。(B) 一个雪球。(C) 一个福乐球。投掷的目标位置通过AprilTag识别。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2506.16986v3/x3.png" alt="不同投掷速度的性能"></p>
<blockquote>
<p><strong>图3</strong>：不同投掷速度下的性能（着陆误差）。误差条表示超过50次投掷的标准差。所提方法（蓝色）在1.5 m/s到6 m/s的速度范围内均保持较低的着陆误差。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2506.16986v3/x4.png" alt="与人类投掷对比"></p>
<blockquote>
<p><strong>图4</strong>：与人类投掷表现对比。(上) 成功投掷到3-5米外小目标的百分比。(下) 投掷速度跟踪误差。机器人系统在成功率和速度精度上均显著优于人类参与者。</p>
</blockquote>
<p><strong>消融实验</strong>：<br>研究移除了残差策略和/或拉回管加速度模块，以评估各组件贡献。</p>
<p><img src="https://arxiv.org/html/2506.16986v3/x5.png" alt="消融研究：着陆误差"></p>
<blockquote>
<p><strong>图5</strong>：消融研究的着陆误差。完整方法（蓝）性能最佳。仅使用名义策略（绿）误差最大。添加残差策略（橙）或拉回管加速度（红）均能提升性能，但两者结合效果最好。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2506.16986v3/x6.png" alt="消融研究：速度跟踪"></p>
<blockquote>
<p><strong>图6</strong>：消融研究的速度跟踪误差。完整方法（蓝）的速度跟踪最为精确。拉回管加速度模块（红）本身对速度跟踪的改善有限，其主要贡献在于通过调整加速度来补偿释放时机误差，从而改善着陆精度（如图5所示）。</p>
</blockquote>
<p><strong>消融实验总结</strong>：名义策略是基础但精度有限；高频残差策略显著改善了EE状态（尤其是速度）的跟踪精度；拉回管加速度优化器则专门针对释放时机不确定性进行补偿，进一步提升着陆精度；三者结合实现了最佳性能。</p>
<h2 id="总结与启发">总结与启发</h2>
<p><strong>核心贡献</strong>：</p>
<ol>
<li>提出了一个结合学习与模型控制的框架，用于腿式移动机械臂的连续全身预抓握投掷，并在硬件上实现了量化的高精度。</li>
<li>引入了高频残差策略，以更高的控制频率修正名义策略的输出，显著提升了动态EE状态跟踪精度。</li>
<li>设计了一个高效的拉回管加速度优化模块，将开环的鲁棒运动规划转化为闭环实时优化问题，使系统能主动将EE状态拉回至有效投掷区域（BRT），从而对抗释放时机不确定性。</li>
</ol>
<p><strong>局限性</strong>：论文提到，当前工作假设物体仅受重力影响，未考虑空气阻力等更复杂的动力学。此外，策略训练需要大量的仿真时间（名义策略约2457.6小时，残差策略约655.4小时）。</p>
<p><strong>启示</strong>：本工作展示了学习与模型基于方法在复杂动态操控任务上协同的有效性，高频反馈与针对关键不确定性（如释放时机）的专门优化模块是提升性能的关键。未来研究可探索将拉回管加速度思想扩展到更复杂的物体动力学模型，并进一步优化训练效率。</p>

      </section>
      <section class="detail-tldr">
        <h2>💡 一句话总结</h2>
        <p>本文针对足式移动机械臂预抓握全身投掷任务，解决了释放时机不确定和高度动态下末端执行器精准跟踪两大核心难题。提出了一种结合学习与模型控制的框架，包括末端执行器名义跟踪策略、提升跟踪精度的高频残差策略，以及优化末端加速度的模块。实验表明，在投掷6米远目标时平均着陆误差为0.28米；以6米/秒速度投掷3-5米随机目标时，系统速度跟踪误差为0.398米/秒，成功率达56.8%，远超人类的15.2%。</p>
      </section>
      <div class="detail-actions">
        <a href="http://arxiv.org/abs/2506.16986" target="_blank" rel="noreferrer" class="btn">查看 arXiv 原文</a>
        <a href="../index.html" class="btn btn-outline">返回列表</a>
      </div>
    </article>
  </main>
  <footer class="site-footer">
    <span>数据抓取来源于 Robotics arXiv Daily</span>
    <span>本页由 GitHub Actions 定时更新</span>
  </footer>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
</body>
</html>