<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>RAPT: Model-Predictive Out-of-Distribution Detection and Failure Diagnosis for Sim-to-Real Humanoid Robots - Robotics arXiv Daily</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="../assets/styles.css"/>
  <link rel="stylesheet" href="../assets/detail.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/>
</head>
<body>
  <div class="bg-orbit"></div>
  <header class="site-header">
    <div class="brand">
      <a href="../index.html" class="back-link">← 返回列表</a>
    </div>
  </header>
  <main class="detail-main">
    <article class="detail-card">
      <span class="detail-category">Robotics (cs.RO)</span>
      <h1>RAPT: Model-Predictive Out-of-Distribution Detection and Failure Diagnosis for Sim-to-Real Humanoid Robots</h1>
      <div class="detail-meta">
        <span>arXiv: <a href="http://arxiv.org/abs/2602.01515" target="_blank" rel="noreferrer">2602.01515</a></span>
        <span>作者: Munn, Humphrey, Tidd, Brendan, Bohm, Peter, Gallagher, Marcus, Howard, David</span>
        <span>日期: 2026/02/02</span>
      </div>
      <section class="detail-body">
        <h2>📝 详细解读</h2>
        <h2 id="研究背景与动机">研究背景与动机</h2>
<p>目前，将深度强化学习策略部署到人形机器人上面临严峻挑战：在仿真中表现鲁棒的策略，在经历仿真到现实迁移后，可能会在分布外状态下自信地执行，导致静默失败，并带来硬件损坏风险。尽管异常检测可以缓解此类失败，但现有方法存在诸多局限。生成式方法，特别是基于LSTM的变分自编码器，是机器人时间序列异常检测的主流范式，但它们常受“输入复杂性偏差”影响，即模型可能因背景统计特性而非语义相关性，给OOD输入分配比训练数据更高的似然。此外，通用时间序列方法常忽略腿式系统固有的刚体约束，将关节传感器视为独立通道，未能对定义有效运动的关节状态与基座动力学之间的严格机械耦合和非线性依赖进行建模。最关键的是，当前的安全防护通常作为不透明的黑盒运行，仅提供二进制停止信号，缺乏诊断可解释性，无法帮助理解仿真与现实差距的根源。</p>
<p>本文针对人形机器人高频控制部署中静默失败的风险以及现有异常检测方法缺乏可解释性的痛点，提出了一个新视角：将域偏移（Sim-to-Real差距）视为可观察的部署时信号，而非需要消除的二元结果。本文的核心思路是：学习一个概率化的时空流形来表征名义行为，并在部署时评估预测偏差，将其转化为一个校准的、可解释的每维度信号，从而实现可靠的在线OOD检测和事后根因分析。</p>
<h2 id="方法详解">方法详解</h2>
<p>RAPT方法整体流程包含四个阶段：(i) 在仿真中从专家策略收集名义执行数据；(ii) 在此数据上训练一个概率化的自监督检测器；(iii) 在部署期间执行实时分布外检测；(iv) 使用基于损失的显著性和基于LLM的诊断代理进行事后根因分析。</p>
<p><img src="https://arxiv.org/html/2602.01515v1/x2.png" alt="方法概述"></p>
<blockquote>
<p><strong>图2</strong>：RAPT方法概述。(A) RAPT的OOD检测架构。(B) 使用三个统计门控的层次化OOD检测流程，用于实时（约1.6毫秒）监控。(C) 检测到的异常触发基于梯度的显著性生成，用于通过多模态LLM进行零样本诊断。</p>
</blockquote>
<p><strong>核心模块与技术细节</strong>：</p>
<ol>
<li><strong>残差状态编码器</strong>：将观测向量 (\mathbf{o}_t) 投影到更高维的潜在嵌入 (\mathbf{e}_t)（维度256）。编码器是一个多层感知机，包含一个初始投影层和L=4个残差块，以捕获跨机器人自由度的非线性运动学耦合。</li>
<li><strong>循环潜在桥</strong>：在潜在空间中引入一个门控循环单元（GRU），用于建模时间依赖性。GRU更新隐藏状态 (\mathbf{h}_t) 并输出一个总结近期时空上下文的特征向量 (\mathbf{g}_t)。训练时序列展开50步，推理时隐藏状态在线传播。</li>
<li><strong>潜在瓶颈与概率解码器</strong>：为避免过参数化自编码器收敛到平凡恒等映射，采用了加性高斯噪声的降噪策略。循环特征 (\mathbf{g}_t) 被投影到一个潜在向量 (\mathbf{z}_t)（维度192）。概率解码器 (g_\theta) 参数化一个对角高斯分布来生成重构，输出均值 (\boldsymbol{\mu}_t) 和对数方差 (\log\boldsymbol{\sigma}^2_t)。模型通过最大化名义观测的高斯似然进行端到端训练，允许重构误差根据预测的不确定性进行自适应加权。</li>
</ol>
<p><strong>混合推理与异常检测策略</strong>：<br>检测策略结合了深度上下文异常评分（RAPT）和基于范围的确定性基线，以覆盖学习到的上下文偏差和确定性的状态空间约束违反。</p>
<ul>
<li><strong>NLL校准与Sim-to-Real适应</strong>：为解决传感器噪声、摩擦等差异导致的静态域偏移，在目标域进行短暂校准。记录校准期间观测到的每维度负对数似然最大值和全局平均值，并采用“最大值加k倍标准差”规则设定阈值。对全局均值应用较紧的界限（k=3），对每维度应用较松的界限（k=5），以在抑制误报的同时保持对动态异常的敏感性。</li>
<li><strong>边界框范围检测器</strong>：并行运行一个简单的基于范围的检测器（Gate 3），标记超出校准超矩形范围的观测。边界根据名义数据估计并扩展一个裕度δ（仿真中0.05，硬件上0.2）。最终异常决策是三个门控的逻辑或。</li>
</ul>
<p><strong>自动化根因分析</strong>：<br>检测到异常后，启动两阶段诊断流程：</p>
<ol>
<li><strong>基于梯度的时序显著性</strong>：通过时间反向传播扩展积分梯度方法，计算导致最终检测时刻t的异常分数的、长度为H=200的时间窗口内各观测特征的贡献度。由于梯度是针对NLL计算，高不确定性维度的偏差会被降权，从而使显著性图聚焦于违反高置信度动态约束的部分。</li>
<li><strong>基于LLM的根因分析</strong>：将时序显著性矩阵、任务上下文（如指令速度）、故障前窗口的运动学状态轨迹以及可选的外部相机关键帧组合成提示，提供给一个大型多模态语言模型。LLM在预定义的故障类别集上进行零样本分类，产生语义假设以辅助操作员诊断。</li>
</ol>
<p>与现有方法相比，RAPT的创新点在于：1) 将重构似然重新定义为部署期间仿真与现实差距的校准连续测量；2) 采用混合检测策略，兼具上下文感知和硬安全边界；3) 结合梯度显著性和LLM推理，实现了从异常检测到语义诊断的闭环。</p>
<h2 id="实验与结果">实验与结果</h2>
<p><strong>实验设置</strong>：在NVIDIA Isaac Lab仿真环境和真实的Unitree G1（29自由度）人形机器人上进行评估。任务包括速度跟踪 locomotion、运动模仿（Dance102, Gangnam Style）和投掷。在仿真中使用4096个并行环境进行大规模OOD评估，注入15类OOD扰动（传感器故障、物理扰动、软件错误等）。真实部署涉及外部推动、可变形地形、附加负载等多种扰动。</p>
<p><strong>对比方法</strong>：与代表性的先进异常检测器进行对比，包括PatchAD、LSTM-VAE、Deep SVDD和Isolation Forest。</p>
<p><strong>关键实验结果</strong>：<br>在仿真大规模评估中，在固定的每episode 0.5%误报率下，RAPT的真阳性率比最强的基线（LSTM-VAE）提高了37%。在真实世界部署中，RAPT实现了12.5%的TPR提升。在仅使用本体感知数据的情况下，RAPT对16种真实世界故障的根因分类准确率达到75%。</p>
<p><img src="https://arxiv.org/html/2602.01515v1/x1.png" alt="真实世界OOD场景"></p>
<blockquote>
<p><strong>图1</strong>：人形机器人部署期间遇到的真实世界分布外场景。RAPT在线检测异常并触发预定义的安全响应，包括安全停止、受控跌倒和恢复行为。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2602.01515v1/x3.png" alt="安全与性能对比表"></p>
<blockquote>
<p><strong>表I</strong>：安全与性能对比。报告了每项任务在0.5% FPR下的安全分数（TPR）以及聚合AUROC。RAPT在所有任务的两项指标上均获得最高值。</p>
</blockquote>
<p><strong>消融实验分析</strong>：论文中的消融实验（表II，未提供图片链接）表明，适度的潜在空间压缩（维度192）比更激进的压缩表现更好，是稳定的操作点。同时，混合检测策略（RAPT + 范围检测器）相比仅使用模型（Model Only）能提供更全面的安全保障。</p>
<h2 id="总结与启发">总结与启发</h2>
<p><strong>核心贡献</strong>：</p>
<ol>
<li><strong>部署时仿真与现实差距测量</strong>：将重构似然重新定义为校准的、连续的仿真与现实不匹配测量，将域偏移视为可观察信号，实现了超越成功率指标的细粒度监控和调试。</li>
<li><strong>轻量级在线OOD检测器</strong>：提出了RAPT，一个用于人形机器人高频（50Hz）控制的循环概率模型，在locomotion、操作和模仿任务上 consistently 优于先前方法。</li>
<li><strong>基于显著性的故障诊断</strong>：提出了一个事后诊断流程，通过时间追溯重构敏感性，并将基于梯度的显著性模式映射到有语义意义的故障描述，结合多模态LLM实现零样本故障模式分类。</li>
</ol>
<p><strong>局限性</strong>：论文自身提到，该方法依赖于名义数据的质量；对于某些密切相关的物理现象，LLM的诊断可能存在模糊性；安全响应是预定义的，并非由RAPT自主合成。</p>
<p><strong>对后续研究的启示</strong>：RAPT为安全关键的高维机器人系统部署提供了一种新范式，即不追求完全消除仿真与现实差距，而是将其量化、监控并用于诊断。其将深度概率模型与可解释性分析、大语言模型相结合的思路，为构建更透明、更可靠的自主系统开辟了道路。未来的工作可以探索更自主的安全响应合成，或将诊断反馈回路用于在线策略适应。</p>

      </section>
      <section class="detail-tldr">
        <h2>💡 一句话总结</h2>
        <p>本文针对人形机器人从仿真到现实部署中，策略在分布外状态下“自信地”执行导致无声故障和硬件风险的核心问题，提出了RAPT监控框架。该方法通过自监督学习仿真中的正常时空流形，在线评估预测偏差以实现校准化的异常检测，并构建了结合梯度显著性与大语言模型的事后故障诊断流程。实验表明，在严格误报率约束下，RAPT在仿真中真阳性率提升37%，在实物部署中真阳性率提升12.5%，并对16种现实故障达到了75%的根因分类准确率。</p>
      </section>
      <div class="detail-actions">
        <a href="http://arxiv.org/abs/2602.01515" target="_blank" rel="noreferrer" class="btn">查看 arXiv 原文</a>
        <a href="../index.html" class="btn btn-outline">返回列表</a>
      </div>
    </article>
  </main>
  <footer class="site-footer">
    <span>数据来源：<a href="https://jiangranlv.github.io/robotics_arXiv_daily/" target="_blank">Robotics arXiv Daily</a></span>
    <span>由 GitHub Actions 自动更新 · AI 摘要仅供参考</span>
  </footer>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
</body>
</html>