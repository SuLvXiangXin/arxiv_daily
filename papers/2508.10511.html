<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>KDPE: A Kernel Density Estimation Strategy for Diffusion Policy Trajectory Selection - Robotics arXiv Daily</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="../assets/styles.css"/>
  <link rel="stylesheet" href="../assets/detail.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/>
</head>
<body>
  <div class="bg-orbit"></div>
  <header class="site-header">
    <div class="brand">
      <a href="../index.html" class="back-link">← 返回列表</a>
    </div>
  </header>
  <main class="detail-main">
    <article class="detail-card">
      <span class="detail-category">Manipulation</span>
      <h1>KDPE: A Kernel Density Estimation Strategy for Diffusion Policy Trajectory Selection</h1>
      <div class="detail-meta">
        <span>arXiv: <a href="http://arxiv.org/abs/2508.10511" target="_blank" rel="noreferrer">2508.10511</a></span>
        <span>作者: Lorenzo Natale Team</span>
        <span>日期: 2025-08-15</span>
      </div>
      <section class="detail-body">
        <h2>📝 详细解读</h2>
        <h2 id="研究背景与动机">研究背景与动机</h2>
<p>当前，Diffusion Policy (DP) 因其能够处理训练数据中的多模态行为，已成为机器人行为克隆中一种强大的策略表示方法。然而，DP存在两个主要缺陷：首先，其去噪过程的随机性会显著影响生成动作轨迹的质量；其次，作为一种监督学习方法，它可能学习到训练数据集中的异常值。这些缺陷可能导致机器人在策略执行时偏离数据分布。现有工作试图通过结合大规模训练或经典行为克隆算法来缓解这些限制。本文则提出了一个不同的视角：在推理时，通过分析DP生成轨迹的统计特性，主动过滤掉有害的轨迹。本文核心思路是：并行生成多条候选轨迹，利用一种流形感知的核密度估计（KDE）方法对轨迹的最终动作进行概率密度估计，并选择密度最高的轨迹执行，从而筛选出最能代表学习到的多模态分布的轨迹。</p>
<h2 id="方法详解">方法详解</h2>
<p>KDPE 旨在增强 Diffusion Policy，其整体流程分为两步：1）<strong>多假设采样</strong>：给定当前观测，并行启动 N 个独立的去噪过程，生成 N 条候选动作轨迹；2）<strong>基于密度的轨迹选择</strong>：对这 N 条轨迹的最后一个动作（即即将执行的动作）进行核密度估计，计算每个动作的概率密度，并选择密度最高的动作所对应的整条轨迹作为输出。</p>
<p><img src="https://arxiv.org/html/2508.10511v2/x1.png" alt="方法框架"></p>
<blockquote>
<p><strong>图1</strong>：使用本文提出的流形感知核进行KDE估计的概率密度函数可视化。在平面上有6个末端执行器动作（表示为坐标系），其中3个代表夹爪打开（绿色圆圈），3个代表夹爪闭合（红色圆圈）。每个热图中的颜色表示在该2D位置、具有特定朝向和夹爪状态（由白色方块内的指示坐标系显示）的动作的密度值。从左到右，我们改变指示坐标系的旋转角度（0到90度），观察到KDE返回的密度值相应变化，当探测的动作接近用于建模PDF的样本时密度达到峰值。该图展示了KDE如何正确处理多模态，并为最具代表性的样本提供最高的密度值。最右侧的两张图展示了KDE如何正确地区分夹爪状态。</p>
</blockquote>
<p>核心模块是<strong>流形感知的核密度估计</strong>。DP输出的动作 $\mathbf{a}_i = [\mathbf{t}_i; \mathbf{R}_i; \mathbf{g}_i]$ 包含欧几里得空间的位置 $\mathbf{t}_i$、非欧几里得空间（SO(3)）的旋转 $\mathbf{R}_i$ 以及欧几里得空间的夹爪开合状态 $\mathbf{g}_i$。标准的多变量高斯核无法直接处理SO(3)流形上的数据。因此，本文修改了现有工作[4]中的概率分布，以同时处理位姿和夹爪状态。</p>
<p>定义的核函数为：<br>$$k(\mathbf{a}<em>i, \mathbf{a}<em>j)=\frac{1}{\sqrt{(2\pi)^{D}|\mathbf{H}|}}\exp\left(-\frac{1}{2}\mathbf{\Delta}</em>{ij}^{\top}\mathbf{H}^{-1}\mathbf{\Delta}</em>{ij}\right)$$<br>其中，协方差矩阵 $\mathbf{H}=\text{diag}\big{(}\sigma_{\text{pos}}^{2}\mathbf{I}<em>{3},,\sigma</em>{\text{rot}}^{2}\mathbf{I}<em>{3},,\sigma</em>{\text{grip}}^{2}\mathbf{I}<em>{1}\big{)}$。关键创新在于差异向量 $\mathbf{\Delta}</em>{ij}$ 的定义，它针对不同流形成分进行了专门处理：<br>$$\mathbf{\Delta}<em>{ij}=[\underbrace{\mathbf{t}<em>i-\mathbf{t}<em>j}</em>{\text{Euclidean}};\underbrace{\log(R</em>{j}^{T}R</em>{i})^{\vee}}<em>{\mathrm{SO}(3)};\underbrace{\mathbf{g}<em>i-\mathbf{g}<em>j}</em>{\text{Euclidean}}]$$<br>对于位置和夹爪分量，使用标准的欧几里得差。对于旋转，则计算从 $R_j$ 到 $R_i$ 的变换，并通过李群对数映射 $\log: \mathrm{SO}(3)\to\mathfrak{so}(3)$ 和 vee 算子 $(\cdot)^{\vee}: \mathfrak{so}(3)\to\mathbb{R}^{3}$ 将其转换为切空间中的轴角表示（即旋转向量）。$|\log(R</em>{j}^{\top}R</em>{i})^{\vee}|$ 即为 $R_i$ 和 $R_j$ 之间的测地线距离（最小旋转角）。</p>
<p>得到核函数后，对于由DP预测的N个最终动作 ${\mathbf{a}<em>i}</em>{i=1}^{N}$，任意动作 $\tilde{\mathbf{a}}$ 的概率密度估计为：$\rho(\tilde{\mathbf{a}})=\frac{1}{N}\sum_{i=1}^{N}k(\tilde{\mathbf{a}},\mathbf{a}_i)$。最后，计算每个候选动作自身的密度 $\rho_i = \rho(\mathbf{a}_i)$，并选择密度最高的 $\mathbf{a}_i$ 所对应的完整轨迹 $\mathbf{A}_i$ 输出。</p>
<p>与现有方法相比，KDPE的创新点在于：1) <strong>推理时优化</strong>：无需重新训练或额外训练价值函数，直接在推理时利用DP生成轨迹的统计特性进行筛选；2) <strong>流形感知核</strong>：提出了一个统一的核函数，能够同时、恰当地处理混合了欧几里得和非欧几里得（SO(3)）分量的机器人动作空间；3) <strong>计算高效</strong>：相比需要对整个高维轨迹进行聚类的非参数方法，KDPE仅对最后一个低维动作进行密度估计，计算开销小。</p>
<h2 id="实验与结果">实验与结果</h2>
<p><strong>实验设置</strong>：使用了来自两个基准的共7个模拟任务进行评估：RoboMimic的 <em>Lift</em>, <em>Can</em>, <em>Square</em>, <em>ToolHang</em> 和 MimicGen的 <em>Coffee</em>, <em>Stack</em>, <em>Assembly</em>。此外，还在三个真实机器人任务（<em>PickPlush</em>, <em>CubeSort</em>, <em>CoffeeMaking</em>）上进行了验证。实验平台涉及模拟环境和Franka Emika Panda真实机械臂。</p>
<p><strong>对比方法</strong>：主要对比基线是原始Diffusion Policy (DP)。此外，还设置了两个变体作为对比和分析：1) <strong>KDPE-OOD</strong>：选择密度最低（最可能是异常值）的轨迹，用以反证异常值过滤的必要性；2) <strong>Tr-KDPE</strong>：尝试对整个轨迹（而非仅最后一个动作）进行条件KDE，以验证仅对最终动作进行筛选的有效性。实验报告了CNN-based (C) 和 Transformer-based (T) 两种骨干网络的结果。</p>
<p><img src="https://arxiv.org/html/2508.10511v2/x2.png" alt="实验任务"></p>
<blockquote>
<p><strong>图2</strong>：用于评估KDPE的RoboMimic（<em>Lift</em>, <em>Can</em>, <em>Square</em>, <em>ToolHang</em>）和MimicGen（<em>Coffee</em>, <em>Stack</em>, <em>Assembly</em>）模拟任务示意图。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2508.10511v2/x3.png" alt="真实机器人任务"></p>
<blockquote>
<p><strong>图3</strong>：KDPE自主执行的真实机器人任务：<em>PickPlush</em>（橙色边框）及其变体<em>PickSponge</em>（黄色）、<em>CubeSort</em>（蓝色）和<em>CoffeeMaking</em>（紫色）。</p>
</blockquote>
<p><strong>关键实验结果</strong>：</p>
<ol>
<li><strong>模拟基准测试</strong>：如表1所示，KDPE在两种骨干网络下均优于DP。KDPE-C平均成功率为88.2%，比DP-C（84.9%）高出3.3个百分点。在排除成功率早已饱和的<em>Lift</em>任务后，性能提升更为显著（4.2%）。KDPE在需要高精度的任务（如<em>ToolHang</em>）和使用低质量数据（mh）训练的任务上提升更大。KDPE-OOD性能大幅下降，尤其是在KDPE表现好的任务上，这证实了过滤异常值的重要性。Tr-KDPE性能与DP相似，未带来显著提升，作者归因于对高维整个轨迹进行KDE会遭遇“维度灾难”。</li>
</ol>
<p><img src="https://arxiv.org/html/2508.10511v2/x4.png" alt="结果表格"></p>
<blockquote>
<p><strong>表1</strong>：DP、KDPE-OOD、Tr-KDPE和KDPE在RoboMimic和MimicGen任务上的平均成功率（%）。最后一列报告了所有任务的平均成功率。该图表表明KDPE-C是整体性能最好的方法。</p>
</blockquote>
<ol start="2">
<li><p><strong>视觉扰动鲁棒性</strong>：通过改变物体颜色引入视觉域偏移。如表2所示，在扰动环境下，KDPE仍然以与未扰动环境相似的幅度优于DP，证明了其筛选机制在噪声设置下的有效性。</p>
</li>
<li><p><strong>真实机器人实验</strong>：如表3所示，在三个真实任务上，KDPE-C均取得了比DP-C更高的成功率（<em>PickPlush</em>: 96% vs 90%; <em>CubeSort</em>: 44% vs 41%; <em>CoffeeMaking</em>: 70% vs 60%）。此外，KDPE表现出更平滑的机器人行为。</p>
</li>
<li><p><strong>推理时间</strong>：在NVIDIA RTX 3080 GPU上，生成100条轨迹的DP-C耗时约90ms（77ms + 13ms），执行KDE仅增加3ms。因此，DP-C控制频率约为12.99 Hz，而KDPE-C约为10.75 Hz，仅增加了约2.24 Hz的计算开销。Tr-KDPE-C的KDE需要30ms，频率降至8.33 Hz，验证了仅对最终动作进行KDE的高效性。</p>
</li>
</ol>
<h2 id="总结与启发">总结与启发</h2>
<p><strong>核心贡献</strong>：1) 提出了KDPE，一种基于KDE、在推理时筛选DP生成的代表性轨迹的方法，无需额外训练；2) 设计了一个流形感知核，用于对包含位置、旋转和夹爪状态的混合流形机器人动作进行密度估计；3) 在7个模拟任务和3个真实机器人任务上进行了广泛的定量评估，证明了KDPE在性能、鲁棒性和效率上的优势。</p>
<p><strong>局限性</strong>：论文指出，KDPE的筛选效果依赖于DP能够生成具有代表性的轨迹分布。如果DP因训练不佳而未能生成这样的分布，KDPE将无法提供性能改进。此外，将KDPE应用于更高维问题（如双手或灵巧手操作）可能会面临核方法固有的“维度灾难”挑战。</p>
<p><strong>后续启示</strong>：KDPE的“生成-筛选”范式可以推广到任何概率生成式策略。未来的研究方向包括：利用KDPE的密度估计来引导DP的去噪过程，而不仅仅是在最后进行选择；探索如何将KDPE有效应用于更高维的动作空间，同时克服维度挑战。这项工作为提升基于生成模型的机器人策略的可靠性和鲁棒性提供了一种简单而有效的推理时优化思路。</p>

      </section>
      <section class="detail-tldr">
        <h2>💡 一句话总结</h2>
        <p>本文针对扩散策略在机器人行为克隆中存在的两个核心问题：去噪过程随机性导致的轨迹质量不稳定，以及可能学习到训练数据中的异常值。提出了一种基于核密度估计的轨迹选择策略KDPE，通过并行生成多条轨迹，并利用一个专门建模末端执行器位姿与夹爪状态的流形感知核函数，估计动作概率密度，从而筛选出最可靠的轨迹。该方法在模拟单臂任务和真实机器人实验中均取得了优于原始扩散策略的性能表现。</p>
      </section>
      <div class="detail-actions">
        <a href="http://arxiv.org/abs/2508.10511" target="_blank" rel="noreferrer" class="btn">查看 arXiv 原文</a>
        <a href="../index.html" class="btn btn-outline">返回列表</a>
      </div>
    </article>
  </main>
  <footer class="site-footer">
    <span>数据抓取来源于 Robotics arXiv Daily</span>
    <span>本页由 GitHub Actions 定时更新</span>
  </footer>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
</body>
</html>