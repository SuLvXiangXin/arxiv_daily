<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Causal Imitation Learning Under Measurement Error and Distribution Shift - Robotics arXiv Daily</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="../assets/styles.css"/>
  <link rel="stylesheet" href="../assets/detail.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/>
</head>
<body>
  <div class="bg-orbit"></div>
  <header class="site-header">
    <div class="brand">
      <a href="../index.html" class="back-link">← 返回列表</a>
    </div>
  </header>
  <main class="detail-main">
    <article class="detail-card">
      <span class="detail-category">Manipulation</span>
      <h1>Causal Imitation Learning Under Measurement Error and Distribution Shift</h1>
      <div class="detail-meta">
        <span>arXiv: <a href="http://arxiv.org/abs/2601.22206" target="_blank" rel="noreferrer">2601.22206</a></span>
        <span>作者: AmirEmad Ghassami Team</span>
        <span>日期: 2026-01-29</span>
      </div>
      <section class="detail-body">
        <h2>📝 详细解读</h2>
        <h2 id="研究背景与动机">研究背景与动机</h2>
<p>模仿学习（IL）旨在从专家演示中学习决策策略，无需明确的奖励信号。行为克隆（BC）是最简单广泛的方法，它将模仿学习简化为监督学习，拟合一个从智能体观察到专家动作的映射。然而，在许多现实场景中，驱动动态和专家决策的真实状态并非直接观测，学习者只能接收到被误差破坏的测量值。当训练和部署之间存在分布偏移时，这种测量误差与分布偏移共存会引发问题。标准BC（无论是基于原始测量值还是忽略它们）都可能收敛到存在系统性偏差的策略，因为它学习到的状态-动作关联是虚假的、非因果稳定的，在分布变化下不可靠。</p>
<p>本文针对测量误差与分布偏移共存的这一具体痛点，提出了一种新的视角：不应模仿观测条件概率 (p(a \mid o))，而应定义一个对潜在状态分布和测量过程变化都具有鲁棒性的最优因果模仿策略。该策略通过反事实干预（(do(S_t = s))）来定义，旨在回答“如果将当前状态设置为(s_t)，专家的行动将如何变化？”这一因果问题。核心思路是：受近端因果推断启发，将噪声状态观测视为代理变量，在无需奖励或交互式专家查询的情况下，从演示数据中识别并估计这一因果最优策略。</p>
<h2 id="方法详解">方法详解</h2>
<p>本文研究在离线模仿学习设定下，部分决策相关状态（(U_t)）是潜在的，且仅通过噪声测量（(W_t)）观测到，同时训练和部署间可能存在分布偏移。专家策略依赖于当前观测状态(S_t)和具有一步延迟的潜在状态(U_{t-1})，即 (A_t \sim \pi_E(\cdot \mid S_t, U_{t-1}))。学习者观测到的数据为 (\mathcal{D} = {(S_{1:T}^{(i)}, W_{0:T-1}^{(i)}, A_{1:T}^{(i)})}_{i=1}^n)。</p>
<p><img src="https://arxiv.org/html/2601.22206v1/x1.png" alt="方法框架"></p>
<blockquote>
<p><strong>图1</strong>：测量误差下模仿学习的因果图。展示了变量间的因果关系：潜在状态(U_t)影响动作(A_t)（有一步延迟）和测量值(W_t)；观测状态(S_t)也影响动作。学习者无法直接观测(U_t)。</p>
</blockquote>
<p>本文提出的因果最优模仿策略 (\pi_{\mathrm{opt}}) 定义为，在干预 (do(S_t = s)) 下专家行动分布的众数：<br>[<br>\pi_{\mathrm{opt}}(s) := \arg\max_{a \in \mathcal{A}} p(A_t^{(s)} = a).<br>]<br>该策略具有两个关键性质：1) <strong>因果解释性</strong>：它等价于在潜在上下文(U_{t-1})的总体分布上，最小化与专家机制(\pi_E(s, U_{t-1}))分歧的贝叶斯最优策略。2) <strong>对分布偏移的鲁棒性</strong>：(\pi_{\mathrm{opt}}) 仅依赖于跨领域不变的专家机制 (\pi_E) 和潜在状态的边际分布 (\mathbb{P}(U_{t-1}))，而不依赖于易变的测量机制 (\mathbb{P}(W_{t-1} | U_{t-1})) 或状态转移动力学 (\mathbb{P}(S_t | U_{t-1}, ...))。相比之下，BC1 ((\pi_{\mathrm{BC1}}(s) = \arg\max p(A_t | S_t=s))) 对潜在状态给定观测状态的后验 (\mathbb{P}(U_{t-1} | S_t)) 的变化敏感；BC2 ((\pi_{\mathrm{BC2}}(s, v) = \arg\max p(A_t | S_t=s, V_{t-1}=v))) 则对测量机制 (\mathbb{P}(W_{t-1} | U_{t-1})) 的变化敏感。</p>
<p>核心创新在于为这一因果目标提供了识别条件和估计方法。受近端因果推断启发，作者将噪声测量 (W_{t-1}) 视为潜在变量 (U_{t-1}) 的代理变量。在满足一定的条件独立性假设（见原文 Assumption 2.1）和完备性条件下，因果目标 (\mathbb{P}(A_t^{(s)} = a)) 可以从观测数据中识别出来。对于离散状态/测量空间，通过求解识别矩方程的样本模拟来估计。对于连续空间，本文提出了一种在再生核希尔伯特空间（RKHS）函数类上的对抗性估计方法（CausIL），通过最小化一个矩损失函数来学习所需参数，从而实现了完全离线的策略恢复。</p>
<h2 id="实验与结果">实验与结果</h2>
<p><strong>实验设置</strong>：本文在来自PhysioNet/Computing in Cardiology Challenge 2019队列的半模拟纵向数据上评估CausIL。该数据模拟了临床决策场景，其中潜在状态(U_t)（如疾病严重程度）通过噪声测量(W_t)（如生命体征）观测，专家动作(A_t)（治疗决定）依赖于(S_t)和(U_{t-1})。实验考虑了三种分布偏移场景：无偏移、潜在状态与观测状态关联偏移（(\mathbb{P}(U_{t-1} | S_t))变化）、测量机制偏移（(\mathbb{P}(W_{t-1} | U_{t-1}))变化）。</p>
<p><strong>对比方法</strong>：主要对比了两个行为克隆基线：(\pi_{\mathrm{BC1}})（仅基于(S_t)）和(\pi_{\mathrm{BC2}})（基于(S_t)和(V_{t-1} = (S_{t-1}, W_{t-1}))）。</p>
<p><strong>关键实验结果</strong>：评估指标是所学策略与专家策略之间在测试域上的均方误差（MSE）。结果表明，在无分布偏移时，所有方法性能相近。但在分布偏移下，CausIL（估计(\pi_{\mathrm{opt}})）表现出显著更强的鲁棒性。</p>
<p><img src="https://arxiv.org/html/2601.22206v1/Results/no_shift.png" alt="无偏移结果"></p>
<blockquote>
<p><strong>图2</strong>：无分布偏移时，CausIL、BC1和BC2的均方误差（MSE）性能接近，说明在稳定环境下因果目标与观测目标一致。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2601.22206v1/Results/shift_on_U.png" alt="U关联偏移"></p>
<blockquote>
<p><strong>图3</strong>：当潜在状态与观测状态的关联（(\mathbb{P}(U_{t-1} | S_t))）发生偏移时，BC1的MSE显著上升，而CausIL保持稳定，验证了(\pi_{\mathrm{opt}})对该类偏移的鲁棒性。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2601.22206v1/Results/shift_on_W.png" alt="W测量偏移"></p>
<blockquote>
<p><strong>图4</strong>：当测量机制（(\mathbb{P}(W_{t-1} | U_{t-1}))）发生偏移时，BC2的MSE显著上升，而CausIL几乎不受影响，验证了(\pi_{\mathrm{opt}})不依赖于易变的测量机制。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2601.22206v1/Results/real_data_no_shift.png" alt="真实数据无偏移"></p>
<blockquote>
<p><strong>图5</strong>：在真实临床数据（无模拟偏移）上，CausIL与BC方法的MSE对比，显示了方法在真实分布下的可行性。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2601.22206v1/Results/real_data_shift_on_U.png" alt="真实数据U偏移"></p>
<blockquote>
<p><strong>图6</strong>：在真实数据上引入(\mathbb{P}(U_{t-1} | S_t))偏移，CausIL相对于BC1的鲁棒性优势依然明显。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2601.22206v1/Results/real_data_shift_on_W.png" alt="真实数据W偏移"></p>
<blockquote>
<p><strong>图7</strong>：在真实数据上引入(\mathbb{P}(W_{t-1} | U_{t-1}))偏移，CausIL相对于BC2的鲁棒性优势同样得到证实。</p>
</blockquote>
<p><strong>消融实验</strong>：本文通过理论分析和模拟实验，实质上对(\pi_{\mathrm{opt}})、(\pi_{\mathrm{BC1}})和(\pi_{\mathrm{BC2}})这三个“组件”（即不同的策略目标）进行了消融研究。结果总结如下：1) (\pi_{\mathrm{opt}}) 组件是鲁棒性的核心，它去除了对非稳定测量机制和状态动力学的依赖。2) 包含(V_{t-1})信息的(\pi_{\mathrm{BC2}})在训练域内预测性更好，但正是因为它依赖于这些信息，使其对测量偏移极度敏感。3) 仅使用(S_t)的(\pi_{\mathrm{BC1}})虽然避免了测量机制依赖，但仍受状态动力学变化的影响。实验结果表明，在各自敏感的分布偏移下，相应的BC方法性能下降，而CausIL（基于(\pi_{\mathrm{opt}})）在所有测试的偏移场景中均保持稳定。</p>
<h2 id="总结与启发">总结与启发</h2>
<p><strong>核心贡献</strong>：</p>
<ol>
<li><strong>提出了因果最优模仿策略</strong>：明确定义了在存在测量误差和延迟潜在混淆情况下的模仿学习目标 (\pi_{\mathrm{opt}})，该目标具有清晰的因果解释，并被证明对特定的分布偏移具有鲁棒性。</li>
<li><strong>提供了识别与估计方案</strong>：借鉴近端因果推断，给出了仅从离线演示数据中识别 (\pi_{\mathrm{opt}}) 的条件，并针对离散和连续空间提出了相应的估计算法（CausIL），首次在测量误差和分布偏移共存的情况下实现了完全离线的因果模仿学习。</li>
<li><strong>实证验证</strong>：在临床决策的半模拟数据上验证了所提方法的有效性，证明了其在分布偏移下优于标准行为克隆基线的鲁棒性。</li>
</ol>
<p><strong>局限性</strong>：</p>
<ol>
<li>识别依赖于严格的条件独立性假设和代理变量的“完备性”条件，这些条件在实际中可能难以完全满足或验证。</li>
<li>方法主要关注外生分布偏移（环境/测量管道变化），对由策略自身行动引起的内生分布偏移（复合误差）的讨论有限。</li>
<li>连续空间中的对抗性估计方法可能面临计算复杂性和优化挑战。</li>
</ol>
<p><strong>启示</strong>：</p>
<ol>
<li>为处理具有不完美感知和跨域部署的模仿学习问题提供了一个新的因果推理框架。</li>
<li>将噪声测量视为代理变量而非直接状态，为从有噪声的离线数据中恢复稳健策略开辟了新途径。</li>
<li>未来的工作可以探索放松识别假设、将内生与外生偏移共同建模，以及开发更高效的连续空间估计算法。</li>
</ol>

      </section>
      <section class="detail-tldr">
        <h2>💡 一句话总结</h2>
        <p>本文研究存在测量误差和分布偏移的离线模仿学习问题。核心挑战是：决策相关状态仅能通过噪声观测获得，且训练与部署环境存在分布差异，导致标准行为克隆方法产生系统性偏差。作者提出因果模仿学习框架CausIL，基于近端因果推断思想，将噪声观测视为代理变量，并给出无需奖励或专家交互的策略识别条件。针对连续状态空间，采用基于RKHS函数类的对抗学习进行参数估计。在PhysioNet/Computing in Cardiology Challenge 2019的半模拟纵向数据上验证，相比行为克隆基线，CausIL对分布偏移表现出更强的鲁棒性。</p>
      </section>
      <div class="detail-actions">
        <a href="http://arxiv.org/abs/2601.22206" target="_blank" rel="noreferrer" class="btn">查看 arXiv 原文</a>
        <a href="../index.html" class="btn btn-outline">返回列表</a>
      </div>
    </article>
  </main>
  <footer class="site-footer">
    <span>数据抓取来源于 Robotics arXiv Daily</span>
    <span>本页由 GitHub Actions 定时更新</span>
  </footer>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
</body>
</html>