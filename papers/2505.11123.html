<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Conditioning Matters: Training Diffusion Policies is Faster Than You Think - Robotics arXiv Daily</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="../assets/styles.css"/>
  <link rel="stylesheet" href="../assets/detail.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/>
</head>
<body>
  <div class="bg-orbit"></div>
  <header class="site-header">
    <div class="brand">
      <a href="../index.html" class="back-link">← 返回列表</a>
    </div>
  </header>
  <main class="detail-main">
    <article class="detail-card">
      <span class="detail-category">Robotics (cs.RO)</span>
      <h1>Conditioning Matters: Training Diffusion Policies is Faster Than You Think</h1>
      <div class="detail-meta">
        <span>arXiv: <a href="http://arxiv.org/abs/2505.11123" target="_blank" rel="noreferrer">2505.11123</a></span>
        <span>作者: Dong, Zibin, Liu, Yicheng, Li, Yinchuan, Zhao, Hang, Hao, Jianye</span>
        <span>日期: 2025/05/16</span>
      </div>
      <section class="detail-body">
        <h2>📝 详细解读</h2>
        <h2 id="研究背景与动机">研究背景与动机</h2>
<p>当前，去噪生成模型已成为构建视觉-语言-动作模型的主流范式。这类方法将机器人控制视为条件生成问题：给定视觉-语言输入作为条件，模型生成相应的机器人动作序列。尽管动作序列的维度远低于图像或文本，训练VLA模型仍然异常困难且资源密集。现有提升效率的努力方向包括采用更强大的视觉-语言编码器、设计紧凑的动作分词器以及融入更丰富的条件策略，这些研究都指向一个关键洞察：核心挑战可能不在于动作生成本身，而在于模型如何解释和利用条件输入。</p>
<p>本文针对扩散策略训练中的一个根本性挑战：当生成条件难以区分时，训练目标会退化为对边缘动作分布的建模，这种现象被称为“损失崩溃”。这导致策略网络主动忽略条件输入，生成与观测无关的动作，形成一个破坏性的反馈循环。本文提出了一个新视角：通过修改条件流匹配中的源分布来防止这种崩溃。</p>
<p>本文核心思路是提出一种简单通用的解决方案Cocos，将条件流匹配中的源分布修改为依赖于条件，通过将源分布锚定在从条件输入中提取的语义周围，来鼓励更强的条件整合并防止损失崩溃。</p>
<h2 id="方法详解">方法详解</h2>
<p>本文方法基于条件流匹配框架。整体目标是训练一个策略网络 $v_{\theta}(t, x, c)$，以估计给定条件 $c$ 下的条件速度场 $u_t(x|c)$，从而通过求解ODE来生成动作。</p>
<p>传统方法在训练条件扩散策略时，通常将源分布 $p_0(x|c)$ 设为标准高斯分布 $q(x_0)$，与条件 $c$ 独立。目标分布 $p_1(x|c)$ 是数据集中的真实动作分布 $q(x_1, c)$。训练目标如公式(7)所示，鼓励网络输出逼近条件流 $u_t(x|x_1, x_0)$。然而，当条件 $c$ 难以区分时，网络输出 $v_{\theta}(t, x, c)$ 对不同条件的响应变得相似，导致训练目标的梯度对不同条件也趋同，最终使目标退化为一个对所有条件取平均的无条件目标，即发生“损失崩溃”。</p>
<p>本文的核心创新模块是<strong>Cocos</strong>。其关键修改在于将源分布从与条件无关的标准高斯 $q(x_0)$，改为依赖于条件 $c$ 的分布 $q(x_0|c)$。具体而言，Cocos将源分布设定为一个具有固定标准差的高斯分布，其均值来源于条件 $c$ 的潜在表示：<br>$$q(x_0|c) = \mathcal{N}(\mu(c), \sigma^2 I)$$<br>其中，均值 $\mu(c)$ 由一个视觉-语言自编码器产生。该自编码器将条件 $c$（如图像和语言指令）编码成一个低维潜向量，以此作为源分布的锚点。</p>
<p><img src="https://arxiv.org/html/2505.11123v1/extracted/6441485/figures/cocos_main.jpg" alt="方法框架"></p>
<blockquote>
<p><strong>图2</strong>：Cocos方法框架。展示了如何用条件相关的源分布（$q(x_0|c)$，其均值 $\mu(c)$ 由自编码器从条件中提取）替换传统的标准高斯源分布（$q(x_0)$）。这种修改迫使策略网络必须整合条件信息才能进行有效的去噪。</p>
</blockquote>
<p>这一修改的理论意义在于，当源分布依赖于条件时，训练目标的梯度对于不同条件 $c_1$ 和 $c_2$ 的差异可以变得很大，除非对 $q(x_0|c)$ 施加额外的耦合假设。这从理论上打破了损失崩溃的恶性循环，强制策略网络必须区分并利用不同的条件信息才能最小化损失。</p>
<p>实现上，Cocos非常轻量，仅需在现有扩散策略框架中替换源分布的采样过程，添加一个轻量级自编码器来生成 $\mu(c)$，网络结构开销极小，易于实现，且与各种VLA架构和模型规模兼容。</p>
<h2 id="实验与结果">实验与结果</h2>
<p><strong>实验设置</strong>：本文在多样化的设置下进行了全面评估。仿真任务包括LIBERO基准的90个任务和MetaWorld基准的10个任务。真实机器人实验在低成本开源机器人平台SO-100上进行了10个任务，并在高性能xArm机器人平台上进行了10个任务。</p>
<p><strong>对比方法</strong>：主要对比了三种扩散策略变体：1) <strong>DP-scratch</strong>：视觉编码器从头训练；2) <strong>DP-DINOv2</strong>：视觉编码器使用DINOv2权重初始化；3) <strong>Cocos</strong>：本文方法，在DP-DINOv2基础上应用条件相关源分布。</p>
<p><strong>关键实验结果</strong>：</p>
<ol>
<li><strong>训练效率与性能</strong>：在LIBERO基准上，Cocos仅用30K梯度步就达到了基线方法（DP-DINOv2）需要约64.2K步才能达到的 $\pi_0$ 性能，训练速度提升约2.14倍。最终性能也显著优于基线。</li>
</ol>
<p><img src="https://arxiv.org/html/2505.11123v1/extracted/6441485/figures/cocos_learning_curve_libero.png" alt="学习曲线"></p>
<blockquote>
<p><strong>图4</strong>：LIBERO基准上的学习曲线。Cocos（橙色）收敛速度远快于DP-DINOv2（蓝色）和DP-scratch（绿色），且达到更高的最终成功率。</p>
</blockquote>
<ol start="2">
<li><strong>真实机器人性能</strong>：在SO-100和xArm平台的真实任务中，Cocos均取得了最高的平均成功率（SO-100: 80.0%， xArm: 86.0%），显著优于DP-DINOv2（SO-100: 60.0%， xArm: 68.0%）和DP-scratch。</li>
</ol>
<p><img src="https://arxiv.org/html/2505.11123v1/extracted/6441485/figures/cocos_real_robot.png" alt="真实机器人结果"></p>
<blockquote>
<p><strong>图5</strong>：真实机器人任务平均成功率。Cocos在两个不同的机器人平台上均取得最佳性能。</p>
</blockquote>
<ol start="3">
<li><strong>消融实验与案例分析</strong>：<ul>
<li><strong>条件整合分析</strong>：通过计算策略网络隐藏层在注入条件信息前后的余弦相似度和范数尺度变化，发现Cocos导致更低的余弦相似度和更高的范数变化，表明其确实强制网络更深入地处理条件信息。</li>
<li><strong>损失崩溃可视化</strong>：如图3所示，基线方法在面临“向左移”和“向右移”的指令时，因损失崩溃而输出相似的平均动作，忽略了语言指令。Cocos则能成功区分指令，产生正确的差异化动作。</li>
</ul>
</li>
</ol>
<p><img src="https://arxiv.org/html/2505.11123v1/extracted/6441485/figures/loss_collapse.jpg" alt="损失崩溃案例"></p>
<blockquote>
<p><strong>图3</strong>：损失崩溃导致策略退化为输出平均动作（上），忽略“左/右”指令。Cocos（下）防止了崩溃，能根据指令产生正确动作。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2505.11123v1/extracted/6441485/figures/cocos_case_study_libero.jpg" alt="案例分析"></p>
<blockquote>
<p><strong>图8</strong>：在LIBERO任务上的定性结果对比。Cocos能成功完成需要理解场景和指令的复杂任务，而基线方法则失败。</p>
</blockquote>
<p><strong>消融实验总结</strong>：核心组件“条件相关源分布”是性能提升的关键。使用预训练编码器（DINOv2）提供条件表示能带来额外增益，但即使结合随机初始化的编码器，Cocos仍能通过其机制带来显著改善。</p>
<h2 id="总结与启发">总结与启发</h2>
<p><strong>核心贡献</strong>：</p>
<ol>
<li><strong>理论分析</strong>：首次为具有生成条件的流匹配建立了数学框架，并理论证明了当条件难以区分时，策略网络会忽略条件，导致训练目标退化为无条件形式的“损失崩溃”。</li>
<li><strong>方法创新</strong>：提出了Cocos，一种简单、通用、即插即用的解决方案，通过将源分布修改为条件相关的高斯分布，从理论上预防损失崩溃，显著提升扩散策略的训练效率和最终性能。</li>
<li><strong>全面验证</strong>：建立了跨越仿真（LIBERO, MetaWorld）与真实世界（低成本SO-100、高性能xArm）的综合性评估基准，验证了Cocos在不同平台和任务上的通用有效性。</li>
</ol>
<p><strong>局限性</strong>：论文自身提到，Cocos依赖于一个自编码器来压缩条件表示以匹配动作维度。虽然自编码器是轻量级的，但其设计质量和训练稳定性可能会影响最终性能，这引入了一个额外的组件。</p>
<p><strong>后续研究启示</strong>：</p>
<ol>
<li><strong>训练动态的重要性</strong>：本文揭示了对生成模型训练动态，特别是条件整合机制进行理论分析的重要性，这为改进其他条件生成模型提供了新视角。</li>
<li><strong>简单有效的改进</strong>：Cocos的成功表明，有时对基础框架进行微小但原理清晰的修改，可能比增加模型复杂度带来更大的收益。</li>
<li><strong>通用性框架</strong>：Cocos的公式化表述兼容多种去噪生成模型（如扩散模型、流匹配、整流流等），其思想可迁移至更广泛的基于流的条件生成任务中。</li>
</ol>

      </section>
      <section class="detail-tldr">
        <h2>💡 一句话总结</h2>
        <p>本文针对条件扩散策略训练效率低下的问题，指出当生成条件难以区分时，训练目标会退化为建模边际动作分布，即“损失崩溃”。为此，提出名为Cocos的通用解决方案，其关键技术是通过修改条件流匹配中的源分布，使其依赖于条件输入，从而强制策略网络有效利用条件信息。实验表明，该方法在LIBERO基准测试中仅用3万梯度步即达到目标性能，训练速度比原始模型快2.14倍，能以更少的计算和参数量实现高性能。</p>
      </section>
      <div class="detail-actions">
        <a href="http://arxiv.org/abs/2505.11123" target="_blank" rel="noreferrer" class="btn">查看 arXiv 原文</a>
        <a href="../index.html" class="btn btn-outline">返回列表</a>
      </div>
    </article>
  </main>
  <footer class="site-footer">
    <span>数据来源：<a href="https://jiangranlv.github.io/robotics_arXiv_daily/" target="_blank">Robotics arXiv Daily</a></span>
    <span>由 GitHub Actions 自动更新 · AI 摘要仅供参考</span>
  </footer>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
</body>
</html>