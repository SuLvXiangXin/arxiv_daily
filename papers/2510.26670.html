<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Hybrid Consistency Policy: Decoupling Multi-Modal Diversity and Real-Time Efficiency in Robotic Manipulation - Robotics arXiv Daily</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="../assets/styles.css"/>
  <link rel="stylesheet" href="../assets/detail.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/>
</head>
<body>
  <div class="bg-orbit"></div>
  <header class="site-header">
    <div class="brand">
      <a href="../index.html" class="back-link">← 返回列表</a>
    </div>
  </header>
  <main class="detail-main">
    <article class="detail-card">
      <span class="detail-category">Manipulation</span>
      <h1>Hybrid Consistency Policy: Decoupling Multi-Modal Diversity and Real-Time Efficiency in Robotic Manipulation</h1>
      <div class="detail-meta">
        <span>arXiv: <a href="http://arxiv.org/abs/2510.26670" target="_blank" rel="noreferrer">2510.26670</a></span>
        <span>作者: Qiaojun Yu Team</span>
        <span>日期: 2025-10-30</span>
      </div>
      <section class="detail-body">
        <h2>📝 详细解读</h2>
        <h2 id="研究背景与动机">研究背景与动机</h2>
<p>在视觉运动策略学习中，基于扩散的模仿学习因其捕捉多样行为的能力而被广泛采用。然而，基于随机微分方程（SDE）的方法（如DDPM）虽然能产生多模态的动作分布，但推理时需要数十到数百步的去噪迭代，导致高延迟，难以在资源受限的平台上实现低延迟控制。另一方面，基于常微分方程（ODE）的方法（如一致性模型）通过确定性轨迹实现快速采样，但倾向于偏向主导模式，存在模式崩溃的风险，从而降低了行为的多样性和鲁棒性。因此，一个开放性问题是如何在保持快速推理的同时，在复杂的机器人场景中保留并促进多模态性。</p>
<p>本文针对扩散策略中多模态表达与实时效率难以兼得的痛点，提出了一种新的视角：将采样过程解耦为一个保留多模态的随机阶段和一个保证效率的确定性阶段。其核心思路是：运行一个短随机SDE前缀以形成稳定的多模态分支，然后在一个自适应的切换时间点，执行一步一致性跳跃以生成最终动作，从而在保留多样性的同时实现快速推理。</p>
<h2 id="方法详解">方法详解</h2>
<p>Hybrid Consistency Policy (HCP) 的整体框架旨在耦合由反向SDE控制的随机前缀和一步蒸馏，在保持多模态分支的同时实现快速推理。其流程首先使用一个预训练的DDPM教师模型提供随机轨迹；在推理时，从噪声开始运行若干步（<code>Ns</code>步）DDPM去噪，得到一个处于中间噪声状态<code>x_{ts}</code>的样本；随后，通过一个经过一致性蒸馏训练的学生模型<code>g_φ</code>，一步映射到干净的动作<code>x_0</code>。学生模型的训练采用了时变一致性蒸馏，以对齐这种“一跳”生成过程。</p>
<p><img src="https://arxiv.org/html/2510.26670v1/figures/fig3-1.jpg" alt="方法框架"></p>
<blockquote>
<p><strong>图2</strong>：HCP架构概览。(a) 策略管道：机器人状态和多视角图像分别由MLP和ResNet编码。推理时通过一个动作块以相等时间间隔执行动作步骤。(b) 混合采样：DDPM教师提供随机轨迹，而学生通过一致性蒸馏进行训练，以满足在收缩区域的一步ODE映射。</p>
</blockquote>
<p><strong>核心模块与技术细节</strong>：</p>
<ol>
<li><strong>混合得分匹配模型</strong>：该方法在连续的时间噪声调度<code>(α(t), σ(t))</code>域中参数化模型。它利用DDPM教师模型的噪声预测<code>ε̂(x_t, t)</code>，通过公式<code>x_{t-1} = x_t - σ(t) ε̂(x_t, t)</code>执行反向DDPM步骤，获得中间状态<code>x_{ts}</code>。学生模型<code>g_φ</code>则被训练为直接从<code>(x_{ts}, t_s, c)</code>预测<code>x_0</code>，其中<code>c</code>是条件（如观测）。</li>
<li><strong>时变一致性蒸馏</strong>：为了训练学生模型，论文设计了结合两种目标的损失函数。首先，<strong>一致性轨迹匹配损失 <code>L_CTM</code></strong> 强制相邻时间步<code>s</code>和<code>u</code>（<code>s &lt; u</code>）的预测保持一致：<code>L_CTM = || f(x_s, s) - f(x_u, u) ||_2^2</code>，其中<code>f(x_τ, τ) = g_φ(x_τ, τ, c)</code>。这确保了学生模型在切换时间区域附近具有时间不变的预测特性。其次，<strong>去噪匹配损失 <code>L_DSM</code></strong> 直接衡量学生预测的<code>x_0</code>与通过教师模型去噪得到的<code>x_0</code>估计值（或真实专家动作）之间的误差，以提高逐点保真度。总损失为两者的加权和：<code>L_CD = α L_CTM + β L_DSM</code>。</li>
<li><strong>切换时间优化</strong>：切换时间<code>t_s*</code>的选择至关重要，它决定了何时从随机SDE前缀切换到确定性的一致性跳跃。论文提出基于三个准则的自适应选择方法：(i) <strong>模式间隙</strong>：通过高斯混合模型估计样本分布的模式数量，并计算模式间的最小距离，要求其超过阈值<code>τ</code>，以确保分支已稳定形成。(ii) <strong>剩余噪声量</strong>：要求累积噪声份额<code>1 - α_cum(t_s)</code>低于阈值<code>η</code>，表明状态已接近干净区域。(iii) <strong>分布变化率</strong>：计算连续反向步骤间核密度估计（KDE）的<code>L_1</code>差异<code>c(t)</code>，要求<code>c(t_s)</code>接近其最大值，表明分布发生了显著且稳定的变化。满足这些条件的最早时间步即被选为<code>t_s*</code>。</li>
</ol>
<p><strong>创新点</strong>：与现有方法相比，HCP的核心创新在于其<strong>混合采样机制</strong>和<strong>时变蒸馏损失</strong>。它没有完全采用慢速的随机采样或快速的确定性采样，而是将两者结合，在过程早期利用SDE的随机性探索并固化多模态分支，在后期利用ODE的一致性实现快速收敛。此外，其蒸馏损失不仅关注最终输出精度（<code>L_DSM</code>），还显式地约束了轨迹的连贯性（<code>L_CTM</code>），以更好地匹配一步跳跃的生成过程。</p>
<h2 id="实验与结果">实验与结果</h2>
<p><strong>实验设置</strong>：</p>
<ul>
<li><strong>Benchmark/数据集</strong>：模拟任务采用Push-T-Sim和Avoiding-Sim；真实机器人任务包括3个多模态任务（Push-T-Real, Avoiding-Real, Pick&amp;Place）和3个单模态任务（Nail Hammering, Belt Removal, Screwing）。真实任务数据通过VR遥操作收集，每个任务60条成功演示。</li>
<li><strong>实验平台</strong>：使用7自由度Flexiv Rizon机械臂，配备腕部（D415）和第三人称（D435）RealSense相机。推理在RTX 4080 GPU上进行。</li>
<li><strong>Baseline方法</strong>：DP-ddpm (80步), DP-ddim (50步), HCP (25步SDE前缀+1跳), 以及消融版本HCP w/o <code>t_s*</code> (5步SDE前缀+1跳)。</li>
</ul>
<p><strong>关键实验结果</strong>：<br>在模拟多模态任务中（表I），HCP（25步）取得了75.5%的平均成功率，熵为1.50，接近80步DP-ddpm（79%，熵1.76）的多模态容量，并显著优于DP-ddim（87%，熵0）和过早切换的HCP变体（72.5%，熵0.23）。在真实多模态任务中（表II），HCP将每序列动作生成时间从DP-ddpm的0.54秒大幅降低至0.17秒（降低68%），同时保持了可比的整体成功率（73.33% vs 78.33%）和多模态行为（熵1.17 vs 1.49）。在真实单模态任务中（表III），HCP在保持相近成功率（70% vs 73.33%）的同时，显著减少了任务总耗时（14.43秒 vs 18.57秒）。</p>
<p><img src="https://arxiv.org/html/2510.26670v1/figures/fig4-3.jpg" alt="真实世界多模态任务性能"></p>
<blockquote>
<p><strong>图5</strong>：HCP在真实世界多模态任务中的性能展示。HCP成功地为每个任务实现了多种模式，在准确性和多模态能力上表现出接近教师模型的性能。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2510.26670v1/figures/fig4-5.jpg" alt="真实世界单模态任务性能"></p>
<blockquote>
<p><strong>图6</strong>：HCP在真实世界单模态任务中的性能。在工具操作和物体抓取等任务中，HCP的表现与教师模型相当，保持了高准确性。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2510.26670v1/figures/fig4-6.jpg" alt="SDE前缀阶段与可行切换窗口"></p>
<blockquote>
<p><strong>图7</strong>：SDE前缀阶段的模态形成演化。(a) 模态随SDE步数的形成过程，虚线将过程分为三个阶段：分岔前（区域1）、稳定分岔（区域2）和后期收缩（区域3）。(b) 相同步数下的收缩速度和累积噪声份额，峰值速度与低噪声共同指示了<code>t_s*</code>的可行窗口（约15至25步）。</p>
</blockquote>
<p><img src="https://arxiv.org/html/2510.26670v1/figures/fig4-4.jpg" alt="多模态与最优切换时间"></p>
<blockquote>
<p><strong>图8</strong>：Avoiding-Sim任务中的多模态和最优切换时间可视化。在<code>t_s*</code>之后，成功率最高且分支稳定；然后应用一步一致性跳跃获得最终动作。过早切换会降低成功率并导致模式崩溃。</p>
</blockquote>
<p><strong>消融实验总结</strong>：<br>消融实验（对比HCP与HCP w/o <code>t_s*</code>）验证了切换时间的重要性。在Push-T-Sim中，将前缀步数从5步增加到25步，成功率从59%提升至64%，熵从0.47提升至0.92。在真实任务Push-T-Real中，成功率从5%大幅提升至55%。这表明，在模式分岔稳定之前过早切换到确定性跳跃，会导致模式崩溃和性能急剧下降。每个组件（稳定的随机前缀、一致性跳跃、以及用于选择<code>t_s*</code>的准则）共同作用，实现了效率与多模态性的有效权衡。</p>
<h2 id="总结与启发">总结与启发</h2>
<p><strong>核心贡献</strong>：</p>
<ol>
<li>提出了一个用于基于扩散的机器人策略中模式保持蒸馏的通用框架HCP，通过结合短随机SDE前缀和一步一致性跳跃，解耦了模式保留与推理速度。</li>
<li>引入了一种基于稳定模式分岔的切换时间选择准则，以在不牺牲多样性的前提下稳定精度并提高推理效率。</li>
<li>在多样的模拟基准和6个真实世界任务上进行了广泛验证，证明HCP能将动作生成时间减少高达68%，同时保持有竞争力的成功率和多模态覆盖。</li>
</ol>
<p><strong>局限性</strong>：<br>论文自身提到，当前的切换时间估计使用了手动调优的超参数，缺乏完整的理论依据。此外，在如Push-T-Real和Nail Hammering这类动态物体操作任务上，HCP的性能仍落后于完全的SDE教师模型，表明其在处理高度动态场景时仍有改进空间。</p>
<p><strong>对后续研究的启示</strong>：<br>HCP的成功表明，多模态性并不必然伴随慢速推理。这种“随机探索+快速收敛”的混合范式为后续研究提供了新思路：可以探索更自适应、理论更完备的切换机制；可以尝试将类似思想应用于其他需要平衡探索与利用、多样性与效率的序列决策问题；此外，如何将方法扩展到更复杂的、长期的任务中，也是一个值得探索的方向。</p>

      </section>
      <section class="detail-tldr">
        <h2>💡 一句话总结</h2>
        <p>本文针对扩散模仿学习中随机微分方程（SDE）方法采样慢、常微分方程（ODE）方法易模式崩溃，难以兼顾多模态行为与实时效率的问题，提出混合一致性策略（HCP）。该方法先运行短随机SDE前缀至自适应切换时间，再通过一步一致性跳跃输出动作；关键技术为时变一致性蒸馏，结合轨迹一致性目标与去噪匹配目标以对齐生成。实验表明，HCP仅用25步SDE加一跳，在准确性与模式覆盖率上接近80步DDPM教师模型，同时显著降低推理延迟，实现了机器人策略中多模态与实时性的有效解耦。</p>
      </section>
      <div class="detail-actions">
        <a href="http://arxiv.org/abs/2510.26670" target="_blank" rel="noreferrer" class="btn">查看 arXiv 原文</a>
        <a href="../index.html" class="btn btn-outline">返回列表</a>
      </div>
    </article>
  </main>
  <footer class="site-footer">
    <span>数据抓取来源于 Robotics arXiv Daily</span>
    <span>本页由 GitHub Actions 定时更新</span>
  </footer>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
</body>
</html>