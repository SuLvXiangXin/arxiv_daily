<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Resolving State Ambiguity in Robot Manipulation via Adaptive Working Memory Recoding - Robotics arXiv Daily</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="../assets/styles.css"/>
  <link rel="stylesheet" href="../assets/detail.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/>
</head>
<body>
  <div class="bg-orbit"></div>
  <header class="site-header">
    <div class="brand">
      <a href="../index.html" class="back-link">← 返回列表</a>
    </div>
  </header>
  <main class="detail-main">
    <article class="detail-card">
      <span class="detail-category">Manipulation</span>
      <h1>Resolving State Ambiguity in Robot Manipulation via Adaptive Working Memory Recoding</h1>
      <div class="detail-meta">
        <span>arXiv: <a href="http://arxiv.org/abs/2512.24638" target="_blank" rel="noreferrer">2512.24638</a></span>
        <span>作者: Wenchao Ding Team</span>
        <span>日期: 2025-12-31</span>
      </div>
      <section class="detail-body">
        <h2>📝 详细解读</h2>
        <h2 id="研究背景与动机">研究背景与动机</h2>
<p>当前，基于行为克隆的视动策略（如ACT、Diffusion Policy）已成为机器人技能学习的主流范式。然而，这些方法大多依赖马尔可夫假设，仅基于短期观测预测未来轨迹，忽略了长期的时间依赖性。机器人操作中普遍存在<strong>状态模糊性</strong>问题，即相同的观测可能对应多个有效的行为轨迹。例如，在“来回擦拭桌子”或“猜测游戏”中，机器人需要依赖更早的历史信息来判断当前处于任务的哪个阶段。现有方法若简单延长历史窗口会导致计算成本高昂且易过拟合；而手工构建历史表示则标注成本高且难以适应多样的模糊性场景。本文受人类连续推理过程和工作记忆重编码机制的启发，提出了一种配备<strong>自适应工作记忆</strong>的新型视动策略PAM。其核心思路是：通过一个可重编码的上下文查询令牌，从当前观测中自适应提取紧凑的上下文特征作为工作记忆，并利用一个上下文路由器跨步整合长历史窗口内的信息，从而以较低成本实现对状态模糊性的鲁棒消歧。</p>
<h2 id="方法详解">方法详解</h2>
<p>PAM的整体框架将策略推理重构为一个时间依赖的过程，而非一系列独立步骤。在每一步推理中，模型仅编码当前观测，同时维护并更新一个作为工作记忆的上下文特征。</p>
<p><img src="https://arxiv.org/html/2512.24638v1/figures/pipeline.png" alt="方法框架"></p>
<blockquote>
<p><strong>图2</strong>：PAM概述。PAM使用两种特征指导动作生成：从当前帧提取的运动基元，以及从扩展历史窗口中提取的紧凑上下文特征（作为工作记忆）。(a) 帧特征提取器，用于获取这两种特征。(b) 上下文路由器，接收历史上下文特征并利用一组跨不同历史长度的查询令牌来产生紧凑的上下文特征。PAM采用两阶段方式训练，图中展示了不同模型参数子集在两个阶段中的渐进激活情况。</p>
</blockquote>
<p><strong>核心模块与技术细节</strong>：</p>
<ol>
<li><p><strong>因果帧特征提取器</strong>：该模块基于Transformer架构，采用因果注意力掩码处理多模态输入序列（包括经适配器层处理的DINOv2图像特征、MiniLM语言指令嵌入和MLP编码的本体感知状态）。序列中额外添加了两个可学习的查询令牌：<code>q^act</code>和<code>q^ctx</code>。<code>q^act</code>用于提取与动作执行直接相关的<strong>运动基元特征</strong> <code>e_t^act</code>；而<code>q^ctx</code>则作为<strong>自适应工作记忆重编码</strong>的关键，它通过联合关注低级感知线索和高级决策相关特征，提取出代表任务进程和环境变化的<strong>上下文特征</strong> <code>c_t</code>。</p>
</li>
<li><p><strong>上下文路由器</strong>：该模块接收过去若干推理步产生的上下文特征序列 <code>C_t^hist</code>，并利用一组设计用于捕捉不同历史长度信息的查询令牌，对这些特征进行整合与压缩。具体而言，通过一个自注意力层和一个前馈层处理，输出紧凑的<strong>上下文表示</strong> <code>e_t^ctx</code>。这种设计避免了RNN式方法中隐藏状态传播可能导致的表征失真，并通过层级化摘要同时捕获短时域和长时域信息。</p>
</li>
<li><p><strong>多条件动作头</strong>：该模块以运动基元特征 <code>e_t^act</code> 和紧凑上下文特征 <code>e_t^ctx</code> 为条件，基于流匹配预测未来的动作序列块。作者尝试了多种条件注入方式，最终采用<strong>交错的多头交叉注意力</strong>，首先关注运动基元，再关注上下文特征。流匹配损失监督预测的速度场与真实动作方向对齐。</p>
</li>
<li><p><strong>辅助目标</strong>：受人类回忆过程的启发，引入了一个辅助目标，要求模型仅基于紧凑上下文特征 <code>e_t^ctx</code> 来重建历史图像的特征嵌入。这确保了上下文路由器作为一个有效的瓶颈，迫使它保留对消歧至关重要的关键历史信息。总损失为流匹配损失和辅助损失的加权和。</p>
</li>
<li><p><strong>两阶段训练策略</strong>：</p>
<ul>
<li><strong>阶段一（学习运动基元）</strong>：仅激活与运动基元提取相关的参数，动作头直接以 <code>e_t^act</code> 为条件进行训练。此阶段旨在训练一个稳定的多模态帧特征提取器。</li>
<li><strong>阶段二（时间消歧）</strong>：冻结特征提取器并缓存其键值状态，仅激活上下文路由器、动作头中与上下文条件相关的部分以及辅助预测头。此阶段利用第一阶段提取的稳定特征，专注于学习如何利用历史上下文进行消歧。这种策略实现了高效并行采样，避免了顺序训练时间依赖模型的不稳定性和高成本。</li>
</ul>
</li>
</ol>
<p><strong>创新点</strong>：与现有方法相比，PAM的核心创新在于提出了<strong>自适应工作记忆重编码</strong>机制，通过专用的上下文查询令牌动态地从当前观测中提取与任务相关的上下文信息，而非简单地拼接原始特征或传播难以解释的隐藏状态。此外，其<strong>两阶段训练策略</strong>在保证训练稳定性和效率的同时，显著降低了长历史建模的计算开销。</p>
<h2 id="实验与结果">实验与结果</h2>
<p><strong>实验设置</strong>：</p>
<ul>
<li><strong>数据集/任务</strong>：1) 精心设计的7个真实世界机器人任务（如图3所示），覆盖了双向重叠、固定时长静态姿势、顺序子任务依赖、重复时间循环和动态交互响应五种状态模糊性场景。2) 仿真环境中的Libero-Long长视野任务套件（10个任务）。</li>
<li><strong>基线方法</strong>：在真实任务中对比了LongDP（利用多帧感知特征和自监督目标）和MTIL（使用选择性状态空间模型编码全轨迹历史）。在Libero-Long中对比了OpenVLA、Diffusion Policy (DP)、MDT和π0。</li>
<li><strong>平台</strong>：真实实验使用Agilex Piper六轴机械臂，30Hz采集数据，20Hz部署推理。</li>
</ul>
<p><img src="https://arxiv.org/html/2512.24638v1/figures/exp.png" alt="真实世界任务"></p>
<blockquote>
<p><strong>图3</strong>：精心设计的真实世界任务集，右上角标明了主要的状态模糊性类型。每个任务包含多个子任务，任务成功率计算为其子任务的平均完成率。</p>
</blockquote>
<p><strong>关键实验结果</strong>：</p>
<ul>
<li><strong>真实世界任务性能</strong>：如表I所示，PAM在7个任务上平均成功率高达<strong>0.91</strong>，显著优于LongDP（0.61）和MTIL（0.45），分别相对提升49.2%和102.2%。尤其在“Hold the Pot Lid”和“Wipe the Table Twice”等挑战性任务上优势明显。</li>
<li><strong>Libero-Long长视野任务</strong>：如表II所示，PAM取得了**84.7%**的平均成功率，与性能最强的基线π0（85.2%）相当，并显著优于其他基线，证明了其架构在非模糊性长视野任务上也具备良好的泛化能力。</li>
<li><strong>可解释性分析</strong>：如图4所示，通过可视化上下文路由器和特征提取器的注意力图，可以解释PAM的决策逻辑。例如，在“Wipe the Table Twice”任务中，注意力能准确定位到前一个任务阶段的关键帧；在“Guessing Game”中，上下文查询关注历史视觉线索（方块位置），而运动基元查询关注当前本体状态以维持姿势。</li>
</ul>
<p><img src="https://arxiv.org/html/2512.24638v1/figures/attn.png" alt="注意力可视化"></p>
<blockquote>
<p><strong>图4</strong>：PAM展现出强大的可解释性。左图：上下文路由器的注意力图揭示了PAM参考了历史中的哪些部分来解决状态模糊性。右图：提取器的注意力图表明PAM使用了哪些模态进行工作记忆编码。</p>
</blockquote>
<p><strong>消融实验总结（基于表III）</strong>：</p>
<ol>
<li><strong>视觉编码器</strong>：使用轻量级ViT-Small会导致性能大幅下降（从0.91降至0.72），表明充足的表征容量对提取消歧所需上下文线索至关重要。</li>
<li><strong>条件注入机制</strong>：先注入运动基元再注入上下文特征的“Later Inject”方式效果最佳（0.91）。直接拼接或先注入上下文特征效果较差，说明运动基元对于引导动作流形转换具有基础作用。</li>
<li><strong>上下文路由器设计</strong>：使用3个查询令牌的层级化摘要设计效果最好（0.91）。不使用路由器（仅平均池化）或使用单一查询令牌性能显著下降，验证了路由器结构对于减少特征混淆和过拟合的有效性。</li>
<li><strong>上下文特征采样间隔</strong>：间隔15帧（对应约0.5秒）采样效果最优，过密或过疏的采样都会损害性能。</li>
</ol>
<h2 id="总结与启发">总结与启发</h2>
<p><strong>核心贡献</strong>：</p>
<ol>
<li>受人类连续推理和工作记忆重编码启发，提出了PAM，一种配备自适应工作记忆的新型视动策略。其通过上下文查询令牌自适应重编码信息，无需额外标注即可有效适应多样的状态模糊性场景。</li>
<li>提出了一种高效的两阶段训练策略，使PAM能够支持长达300帧（约10秒）的历史窗口，同时保持20Hz的实时推理速度和稳定的训练过程，显著降低了长历史建模的成本。</li>
<li>在涵盖多种状态模糊性场景的7个真实任务上验证了PAM的卓越性能，并在标准长视野基准测试中展现了竞争力。模型还具备良好的可解释性。</li>
</ol>
<p><strong>局限性</strong>：论文提到，300帧的历史窗口覆盖了绝大多数需要历史信息的场景，但对于需要更长上下文的任务，仍需依赖机器人系统中的高层任务规划器来处理。</p>
<p><strong>后续研究启示</strong>：PAM将工作记忆重编码的思想引入机器人学习，为处理时间依赖和非马尔可夫决策问题提供了新思路。其两阶段训练、基于查询的特征分离以及用于保证信息瓶颈的辅助目标等设计，对开发其他需要长序列建模和高效推理的时序模型具有参考价值。</p>

      </section>
      <section class="detail-tldr">
        <h2>💡 一句话总结</h2>
        <p>本文针对机器人操作中普遍存在的状态模糊性问题，即相同观测可能对应多个有效行为轨迹，提出PAM方法。该方法通过自适应工作记忆重编码技术，采用分层帧特征提取器生成运动基元与时序消歧表示，并利用上下文路由器压缩历史信息。实验表明，PAM在约10秒（300帧）的历史窗口下，能稳定训练并保持20Hz以上的推理速度，有效处理多种状态模糊场景。</p>
      </section>
      <div class="detail-actions">
        <a href="http://arxiv.org/abs/2512.24638" target="_blank" rel="noreferrer" class="btn">查看 arXiv 原文</a>
        <a href="../index.html" class="btn btn-outline">返回列表</a>
      </div>
    </article>
  </main>
  <footer class="site-footer">
    <span>数据抓取来源于 Robotics arXiv Daily</span>
    <span>本页由 GitHub Actions 定时更新</span>
  </footer>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
</body>
</html>